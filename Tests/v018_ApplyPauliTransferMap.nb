(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    137044,       3180]
NotebookOptionsPosition[    126194,       2997]
NotebookOutlinePosition[    126642,       3015]
CellTagsIndexPosition[    126599,       3012]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["ApplyPauliTransferMap", "Title",
 CellChangeTimes->{{3.913273690088934*^9, 3.913273712038406*^9}, {
   3.915199103735641*^9, 3.915199106675872*^9}, {3.917086155647716*^9, 
   3.917086158759173*^9}, {3.9171594220183487`*^9, 3.917159422219205*^9}, {
   3.917274433487973*^9, 3.917274435404172*^9}, 3.917277665796289*^9, {
   3.917280864184389*^9, 3.9172808649949007`*^9}, {3.9172828199639874`*^9, 
   3.9172828467690277`*^9}, {3.917341838255602*^9, 3.917341850354156*^9}, {
   3.91745168386106*^9, 
   3.917451684259018*^9}},ExpressionUUID->"77f009f4-2175-44a8-80e3-\
db58a43dd7eb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", " ", "@", " ", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Import", "[", "\"\<../Link/QuESTlink.m\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.917451655155184*^9, 3.9174517069438953`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"96dc3e19-ba26-4783-b8c5-af8507883921"],

Cell[CellGroupData[{

Cell["Doc", "Chapter",
 CellChangeTimes->{{3.912849421029387*^9, 3.912849426146103*^9}, {
  3.912849785066738*^9, 3.912849790979604*^9}, {3.912878442788628*^9, 
  3.912878443004286*^9}, {3.9151991784358664`*^9, 
  3.9151991786465263`*^9}},ExpressionUUID->"2a8ec798-ae11-4a87-9bc0-\
81ab84d2fff7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "ApplyPauliTransferMap"}]], "Input",
 CellChangeTimes->{{3.9174516956311903`*^9, 3.917451699011285*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"fba5918a-c879-4e52-a985-86426b9044bd"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"ApplyPauliTransferMap[pauliString, ptMap] returns \
the Pauli string produced by the given PTMap acting upon the given initial \
Pauli string.\\nApplyPauliTransferMap[pauliString, circuit] automatically \
transforms the given circuit (composed of gates, channels, and PTMs, possibly \
intermixed) into PTMaps before applying them to the given Pauli string.\\nFor \
improved performance, gate parameters should be kept symbolic (and optionally \
substituted thereafter) so that algebraic simplification can identify zero \
elements without interference by finite-precision numerical errors.\\nThis \
method uses automatic caching to avoid needless re-computation of an \
operator's PTMap, agnostic to the targeted and controlled qubits, at the cost \
of additional memory usage. Caching behaviour can be controlled using option \
\\\"CacheMaps\\\":\\n\[Bullet] \\\"CacheMaps\\\" -> \\\"UntilCallEnd\\\" \
(default) caches all computed PTMaps but clears the cache when \
ApplyPauliTransferMap[] returns.\\n\[Bullet] \\\"CacheMaps\\\" -> \\\"Forever\
\\\" maintains the cache even between multiple calls to \
ApplyPauliTransferMap[].\\n\[Bullet] \\\"CacheMaps\\\" -> \\\"Never\\\" \
disables caching (and clears the existing cache before computation), \
re-computing each operqtors' PTMap when encountered in the \
circuit.\\nApplyPauliTransferMap also accepts all options of \
CalcPauliTransferMap, like AssertValidChannels. See \
?AssertValidChannels.\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[
           TagBox[GridBox[{
              {
               StyleBox[
                TagBox[
                 TooltipBox[
                  StyleBox["\<\" Definitions\"\>", "InformationRowLabel",
                   StripOnInput->False],
                  "\"Definitions\"",
                  TooltipStyle->"TextStyling"],
                 Annotation[#, "Definitions", "Tooltip"]& ], "DialogStyle",
                StripOnInput->False]},
              {
               TemplateBox[{"\"\[ThinSpace]\"", 
                 GridBox[{{
                    RowBox[{
                    RowBox[{"ApplyPauliTransferMap", "[", 
                    RowBox[{
                    
                    RowBox[{
                    "QuEST`Private`pauliStr_", "?", 
                    "QuEST`Private`isValidSymbolicPauliString"}], ",", 
                    RowBox[{"QuEST`Private`map", ":", 
                    RowBox[{
                    SubscriptBox["PTMap", "__Integer"], "[", "__Rule", 
                    "]"}]}], ",", 
                    RowBox[{"QuEST`Private`opts", ":", 
                    RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{"QuEST`Private`out", ",", 
                    "QuEST`Private`scalars"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"Check", "[", 
                    RowBox[{
                    
                    RowBox[{"QuEST`Private`validatePauliTransferMapOptions", 
                    "[", 
                    
                    RowBox[{"ApplyPauliTransferMap", ",", 
                    "QuEST`Private`opts"}], "]"}], ",", 
                    RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
                    RowBox[{"QuEST`Private`out", "=", 
                    RowBox[{"Plus", "@@", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"QuEST`Private`inState", "\[LeftDoubleBracket]", 
                    "2", "\[RightDoubleBracket]"}], " ", 
                    
                    RowBox[{"QuEST`Private`outState", "\[LeftDoubleBracket]", 
                    "2", "\[RightDoubleBracket]"}], " ", 
                    RowBox[{"GetPauliString", "[", 
                    
                    RowBox[{"QuEST`Private`outState", "\[LeftDoubleBracket]", 
                    "1", "\[RightDoubleBracket]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"QuEST`Private`inState", ",", 
                    
                    RowBox[{
                    "QuEST`Private`getPauliStringInitStatesForPTMapSim", "[", 
                    
                    RowBox[{"QuEST`Private`pauliStr", ",", 
                    RowBox[{"{", "QuEST`Private`map", "}"}]}], "]"}]}], "}"}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"QuEST`Private`outState", ",", 
                    RowBox[{"QuEST`Private`applyPTMapToPauliState", "[", 
                    RowBox[{
                    
                    RowBox[{"QuEST`Private`inState", "\[LeftDoubleBracket]", 
                    "1", "\[RightDoubleBracket]"}], ",", 
                    "QuEST`Private`map"}], "]"}]}], "}"}]}], "]"}], ",", 
                    "1"}], "]"}]}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "QuEST`Private`out", "]"}], "===", 
                    "Plus"}], ",", 
                    RowBox[{
                    RowBox[{"QuEST`Private`scalars", "=", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"QuEST`Private`out", ",", 
                    RowBox[{"Except", "[", 
                    
                    RowBox[{"_", "?", 
                    "QuEST`Private`isValidSymbolicPauliString"}], "]"}]}], 
                    "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"QuEST`Private`scalars", "=!=", 
                    RowBox[{"{", "}"}]}], "&&", 
                    RowBox[{"!", 
                    RowBox[{"PossibleZeroQ", "[", 
                    RowBox[{"Chop", "[", 
                    RowBox[{"Max", "[", 
                    RowBox[{"Abs", "[", "QuEST`Private`scalars", "]"}], "]"}],
                     "]"}], "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"Message", "[", 
                    RowBox[{
                    StyleBox[
                    RowBox[{"ApplyPauliTransferMap", "::", "error"}], 
                    "MessageName"], ",", 
                    
                    RowBox[{
                    "\"A numerical artefact in ApplyPauliTransferMap[] grew \
too large (to value \"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"StandardForm", "[", 
                    RowBox[{"First", "[", "QuEST`Private`scalars", "]"}], 
                    "]"}], "]"}], "<>", 
                    "\"), and likely resulted from the \"", "<>", 
                    "\"input PTMap being unsimplified or containing an \
insufficiently precise amplitude.\""}]}], "]"}], ";", 
                    RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
                    RowBox[{"QuEST`Private`out", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"QuEST`Private`out", ",", 
                    RowBox[{"Or", "@@", "QuEST`Private`scalars"}]}], 
                    "]"}]}]}]}], "]"}], ";", "QuEST`Private`out"}]}], 
                    "]"}]}]}, {" "}, {
                    RowBox[{
                    RowBox[{"ApplyPauliTransferMap", "[", 
                    RowBox[{
                    
                    RowBox[{
                    "QuEST`Private`pauliStr_", "?", 
                    "QuEST`Private`isValidSymbolicPauliString"}], ",", 
                    RowBox[{"QuEST`Private`maps", ":", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["PTMap", "__Integer"], "[", "__Rule", "]"}], 
                    ".."}], "}"}]}], ",", 
                    RowBox[{"QuEST`Private`opts", ":", 
                    RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Check", "[", 
                    RowBox[{
                    
                    RowBox[{"QuEST`Private`validatePauliTransferMapOptions", 
                    "[", 
                    
                    RowBox[{"ApplyPauliTransferMap", ",", 
                    "QuEST`Private`opts"}], "]"}], ",", 
                    RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
                    RowBox[{"SimplifyPaulis", "[", 
                    RowBox[{"Fold", "[", 
                    
                    RowBox[{"ApplyPauliTransferMap", ",", 
                    "QuEST`Private`pauliStr", ",", "QuEST`Private`maps"}], 
                    "]"}], "]"}]}], ")"}]}]}, {" "}, {
                    RowBox[{
                    RowBox[{"ApplyPauliTransferMap", "[", 
                    RowBox[{
                    
                    RowBox[{
                    "QuEST`Private`pauliStr_", "?", 
                    "QuEST`Private`isValidSymbolicPauliString"}], ",", 
                    RowBox[{"QuEST`Private`mixed", ":", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"_", "?", "QuEST`Private`isGateFormat"}], "|", 
                    RowBox[{
                    SubscriptBox["PTM", "__Integer"], "[", 
                    RowBox[{"_", "?", "SquareMatrixQ"}], "]"}], "|", 
                    RowBox[{
                    SubscriptBox["PTMap", "__Integer"], "[", "__Rule", 
                    "]"}]}], ")"}], ".."}], "}"}]}], ",", 
                    RowBox[{"QuEST`Private`opts", ":", 
                    RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", "QuEST`Private`maps", "}"}], ",", 
                    RowBox[{
                    RowBox[{"Check", "[", 
                    RowBox[{
                    
                    RowBox[{"QuEST`Private`validatePauliTransferMapOptions", 
                    "[", 
                    
                    RowBox[{"ApplyPauliTransferMap", ",", 
                    "QuEST`Private`opts"}], "]"}], ",", 
                    RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}], ";", 
                    RowBox[{"QuEST`Private`maps", "=", 
                    RowBox[{"Check", "[", 
                    RowBox[{
                    
                    RowBox[{"QuEST`Private`getAndValidateAllGatesAsPTMaps", 
                    "[", 
                    
                    RowBox[{"QuEST`Private`mixed", ",", 
                    "ApplyPauliTransferMap", ",", "QuEST`Private`opts"}], 
                    "]"}], ",", 
                    RowBox[{"Return", "[", "$Failed", "]"}]}], "]"}]}], ";", 
                    RowBox[{"ApplyPauliTransferMap", "[", 
                    
                    RowBox[{"QuEST`Private`pauliStr", ",", 
                    "QuEST`Private`maps"}], "]"}]}]}], "]"}]}]}, {" "}, {
                    RowBox[{
                    RowBox[{"ApplyPauliTransferMap", "[", 
                    RowBox[{"QuEST`Private`pauliStr_", ",", 
                    
                    RowBox[{
                    "QuEST`Private`gate_", "?", 
                    "QuEST`Private`isGateFormat"}], ",", 
                    "QuEST`Private`opts___"}], "]"}], ":=", 
                    RowBox[{"ApplyPauliTransferMap", "[", 
                    RowBox[{"QuEST`Private`pauliStr", ",", 
                    RowBox[{"{", "QuEST`Private`gate", "}"}], ",", 
                    "QuEST`Private`opts"}], "]"}]}]}, {" "}, {
                    RowBox[{
                    RowBox[{"ApplyPauliTransferMap", "[", "___", "]"}], ":=", 
                    
                    
                    RowBox[{
                    "QuEST`Private`invalidArgError", "[", 
                    "ApplyPauliTransferMap", "]"}]}]}, {" "}}, 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  DefaultBaseStyle -> "Column", 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]},
                "RowDefault"]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            "Column"],
           FrameMargins->{{6, 0}, {3, 6}}], "\<\"\"\>"},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Options\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Options\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Options", "Tooltip"]& ], 
                   
                   RowBox[{"\<\"CacheMaps\"\>", 
                    "\[Rule]", "\<\"UntilCallEnd\"\>"}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"QuEST`ApplyPauliTransferMap\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"ApplyPauliTransferMap[pauliString, ptMap] returns \
the Pauli string produced by the given PTMap acting upon the given initial \
Pauli string.\\nApplyPauliTransferMap[pauliString, circuit] automatically \
transforms the given circuit (composed of gates, channels, and PTMs, possibly \
intermixed) into PTMaps before applying them to the given Pauli string.\\nFor \
improved performance, gate parameters should be kept symbolic (and optionally \
substituted thereafter) so that algebraic simplification can identify zero \
elements without interference by finite-precision numerical errors.\\nThis \
method uses automatic caching to avoid needless re-computation of an \
operator's PTMap, agnostic to the targeted and controlled qubits, at the cost \
of additional memory usage. Caching behaviour can be controlled using option \
\\\"CacheMaps\\\":\\n\[Bullet] \\\"CacheMaps\\\" -> \\\"UntilCallEnd\\\" \
(default) caches all computed PTMaps but clears the cache when \
ApplyPauliTransferMap[] returns.\\n\[Bullet] \\\"CacheMaps\\\" -> \\\"Forever\
\\\" maintains the cache even between multiple calls to \
ApplyPauliTransferMap[].\\n\[Bullet] \\\"CacheMaps\\\" -> \\\"Never\\\" \
disables caching (and clears the existing cache before computation), \
re-computing each operqtors' PTMap when encountered in the \
circuit.\\nApplyPauliTransferMap also accepts all options of \
CalcPauliTransferMap, like AssertValidChannels. See \
?AssertValidChannels.\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{10., {2., 8.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{10., {2., 8.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[<|
   "ObjectType" -> "Symbol", "Usage" -> 
    "ApplyPauliTransferMap[pauliString, ptMap] returns the Pauli string \
produced by the given PTMap acting upon the given initial Pauli string.\n\
ApplyPauliTransferMap[pauliString, circuit] automatically transforms the \
given circuit (composed of gates, channels, and PTMs, possibly intermixed) \
into PTMaps before applying them to the given Pauli string.\nFor improved \
performance, gate parameters should be kept symbolic (and optionally \
substituted thereafter) so that algebraic simplification can identify zero \
elements without interference by finite-precision numerical errors.\nThis \
method uses automatic caching to avoid needless re-computation of an \
operator's PTMap, agnostic to the targeted and controlled qubits, at the cost \
of additional memory usage. Caching behaviour can be controlled using option \
\"CacheMaps\":\n\[Bullet] \"CacheMaps\" -> \"UntilCallEnd\" (default) caches \
all computed PTMaps but clears the cache when ApplyPauliTransferMap[] \
returns.\n\[Bullet] \"CacheMaps\" -> \"Forever\" maintains the cache even \
between multiple calls to ApplyPauliTransferMap[].\n\[Bullet] \"CacheMaps\" \
-> \"Never\" disables caching (and clears the existing cache before \
computation), re-computing each operqtors' PTMap when encountered in the \
circuit.\nApplyPauliTransferMap also accepts all options of \
CalcPauliTransferMap, like AssertValidChannels. See ?AssertValidChannels.", 
    "Documentation" -> None, "OwnValues" -> None, "UpValues" -> None, 
    "DownValues" -> 
    Information`InformationValueForm[
     DownValues, QuEST`ApplyPauliTransferMap, {QuEST`ApplyPauliTransferMap[
         PatternTest[
          Pattern[QuEST`Private`pauliStr, 
           Blank[]], QuEST`Private`isValidSymbolicPauliString], 
         Pattern[QuEST`Private`map, 
          Subscript[QuEST`Gate`PTMap, 
           BlankSequence[Integer]][
           BlankSequence[Rule]]], 
         Pattern[QuEST`Private`opts, 
          OptionsPattern[]]] :> 
       Module[{QuEST`Private`out, QuEST`Private`scalars}, Check[
           QuEST`Private`validatePauliTransferMapOptions[
           QuEST`ApplyPauliTransferMap, QuEST`Private`opts], 
           Return[$Failed]]; QuEST`Private`out = Apply[Plus, 
            Flatten[
             Table[
             Part[QuEST`Private`inState, 2] Part[QuEST`Private`outState, 2] 
              QuEST`GetPauliString[
                Part[QuEST`Private`outState, 1]], {QuEST`Private`inState, 
               QuEST`Private`getPauliStringInitStatesForPTMapSim[
               QuEST`Private`pauliStr, {QuEST`Private`map}]}, {
              QuEST`Private`outState, 
               QuEST`Private`applyPTMapToPauliState[
                Part[QuEST`Private`inState, 1], QuEST`Private`map]}], 1]]; 
         If[Head[QuEST`Private`out] === Plus, 
           QuEST`Private`scalars = Cases[QuEST`Private`out, 
              Except[
               PatternTest[
                Blank[], QuEST`Private`isValidSymbolicPauliString]]]; If[
             And[QuEST`Private`scalars =!= {}, 
              Not[
               PossibleZeroQ[
                Chop[
                 Max[
                  Abs[QuEST`Private`scalars]]]]]], Message[
               MessageName[QuEST`ApplyPauliTransferMap, "error"], 
               "A numerical artefact in ApplyPauliTransferMap[] grew too \
large (to value " <> ToString[
                 StandardForm[
                  First[QuEST`Private`scalars]]] <> 
               "), and likely resulted from the " <> 
               "input PTMap being unsimplified or containing an \
insufficiently precise amplitude."]; Return[$Failed]]; 
           QuEST`Private`out = DeleteCases[QuEST`Private`out, 
              Apply[Or, QuEST`Private`scalars]]]; QuEST`Private`out], 
       QuEST`ApplyPauliTransferMap[
         PatternTest[
          Pattern[QuEST`Private`pauliStr, 
           Blank[]], QuEST`Private`isValidSymbolicPauliString], 
         Pattern[QuEST`Private`maps, {
           Repeated[
            Subscript[QuEST`Gate`PTMap, 
             BlankSequence[Integer]][
             BlankSequence[Rule]]]}], 
         Pattern[QuEST`Private`opts, 
          OptionsPattern[]]] :> (Check[
          QuEST`Private`validatePauliTransferMapOptions[
          QuEST`ApplyPauliTransferMap, QuEST`Private`opts], 
          Return[$Failed]]; QuEST`SimplifyPaulis[
          Fold[
          QuEST`ApplyPauliTransferMap, QuEST`Private`pauliStr, 
           QuEST`Private`maps]]), QuEST`ApplyPauliTransferMap[
         PatternTest[
          Pattern[QuEST`Private`pauliStr, 
           Blank[]], QuEST`Private`isValidSymbolicPauliString], 
         Pattern[QuEST`Private`mixed, {
           Repeated[
            Alternatives[
             PatternTest[
              Blank[], QuEST`Private`isGateFormat], 
             Subscript[QuEST`Gate`PTM, 
              BlankSequence[Integer]][
              PatternTest[
               Blank[], SquareMatrixQ]], 
             Subscript[QuEST`Gate`PTMap, 
              BlankSequence[Integer]][
              BlankSequence[Rule]]]]}], 
         Pattern[QuEST`Private`opts, 
          OptionsPattern[]]] :> Module[{QuEST`Private`maps}, Check[
           QuEST`Private`validatePauliTransferMapOptions[
           QuEST`ApplyPauliTransferMap, QuEST`Private`opts], 
           Return[$Failed]]; QuEST`Private`maps = Check[
            QuEST`Private`getAndValidateAllGatesAsPTMaps[
            QuEST`Private`mixed, QuEST`ApplyPauliTransferMap, 
             QuEST`Private`opts], 
            Return[$Failed]]; 
         QuEST`ApplyPauliTransferMap[
          QuEST`Private`pauliStr, QuEST`Private`maps]], 
       QuEST`ApplyPauliTransferMap[
         Pattern[QuEST`Private`pauliStr, 
          Blank[]], 
         PatternTest[
          Pattern[QuEST`Private`gate, 
           Blank[]], QuEST`Private`isGateFormat], 
         Pattern[QuEST`Private`opts, 
          BlankNullSequence[]]] :> 
       QuEST`ApplyPauliTransferMap[
        QuEST`Private`pauliStr, {QuEST`Private`gate}, QuEST`Private`opts], 
       QuEST`ApplyPauliTransferMap[
         BlankNullSequence[]] :> 
       QuEST`Private`invalidArgError[QuEST`ApplyPauliTransferMap]}], 
    "SubValues" -> None, "DefaultValues" -> None, "NValues" -> None, 
    "FormatValues" -> None, "Options" -> {"CacheMaps" -> "UntilCallEnd"}, 
    "Attributes" -> {}, "FullName" -> "QuEST`ApplyPauliTransferMap"|>, 
   False]]], "Output",
 CellChangeTimes->{3.917451701158464*^9, 3.917454532568006*^9, 
  3.917454562618086*^9, 3.917507010817315*^9, 3.9175152289542427`*^9, 
  3.917516864749501*^9, 3.9175170679452877`*^9, 3.917517875270945*^9, 
  3.918112302188231*^9, 3.920956144795432*^9, 3.921408303409665*^9, 
  3.921421733272931*^9, 3.92148096524603*^9, 3.921482102474348*^9, 
  3.921482147616206*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"96f4d8c9-34d2-4ee1-b962-700a047227ac"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Correctness", "Chapter",
 CellChangeTimes->{{3.912849421029387*^9, 3.912849426146103*^9}, {
  3.912849785066738*^9, 3.912849790979604*^9}, {3.912878442788628*^9, 
  3.912878443004286*^9}, {3.9151991784358664`*^9, 3.9151991786465263`*^9}, {
  3.9173418805860863`*^9, 3.917341881626457*^9}, {3.917451715663147*^9, 
  3.917451718096586*^9}, {3.917459998504846*^9, 
  3.9174600016077023`*^9}},ExpressionUUID->"02bdf378-83ae-4892-994c-\
456dd1665801"],

Cell[CellGroupData[{

Cell["Maps", "Section",
 CellChangeTimes->{{3.91746001775187*^9, 
  3.91746001813144*^9}},ExpressionUUID->"3046ef3e-0cb3-4f31-95ea-\
17cc025e6c77"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"map", " ", "=", " ", 
   RowBox[{"CalcPauliTransferMap", " ", "@", " ", 
    RowBox[{"Circuit", "[", 
     RowBox[{
      SubscriptBox["H", "0"], 
      RowBox[{
       SubscriptBox["Rx", "0"], "[", "x", "]"}], 
      RowBox[{
       SubscriptBox["C", "0"], "[", 
       SubscriptBox["X", "1"], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"DrawPauliTransferMap", "[", "map", "]"}]}], "Input",
 CellChangeTimes->{{3.917451729108605*^9, 3.917451750355792*^9}, {
   3.917451903687724*^9, 3.917451980751376*^9}, {3.917452196456861*^9, 
   3.917452196639022*^9}, {3.917452448788712*^9, 3.9174524997417727`*^9}, 
   3.917460005483941*^9},
 CellLabel->"In[78]:=",ExpressionUUID->"45ff0713-8931-405a-ae53-38ff226ea5a8"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{0, 1, 3, 6, 2, 5, 4, 7, 8, 11, 9, 13, 10, 14, 12, 
      15}, {{{1, 1}, {2, 3}, {2, 4}, {5, 3}, {5, 4}, {3, 6}, {7, 7}, {6, 5}, {
       6, 8}, {4, 5}, {4, 8}, {8, 2}, {9, 10}, {11, 9}, {11, 12}, {13, 9}, {
       13, 12}, {10, 14}, {15, 16}, {12, 11}, {12, 15}, {14, 11}, {14, 15}, {
       16, 13}}, Null}, {
      EdgeLabels -> {
        DirectedEdge[14, 9] -> -Cos[$CellContext`x], DirectedEdge[1, 3] -> 
         Cos[$CellContext`x], DirectedEdge[5, 7] -> Cos[$CellContext`x], 
         DirectedEdge[4, 4] -> 1, DirectedEdge[3, 5] -> 1, 
         DirectedEdge[2, 6] -> -Cos[$CellContext`x], 
         DirectedEdge[1, 6] -> -Sin[$CellContext`x], DirectedEdge[12, 15] -> 
         1, DirectedEdge[6, 2] -> -Cos[$CellContext`x], 
         DirectedEdge[5, 2] -> -Sin[$CellContext`x], 
         DirectedEdge[2, 3] -> -Sin[$CellContext`x], 
         DirectedEdge[6, 7] -> -Sin[$CellContext`x], DirectedEdge[0, 0] -> 1, 
         DirectedEdge[8, 11] -> 1, 
         DirectedEdge[14, 12] -> -Sin[$CellContext`x], DirectedEdge[11, 14] -> 
         1, DirectedEdge[10, 13] -> Cos[$CellContext`x], DirectedEdge[9, 8] -> 
         Cos[$CellContext`x], DirectedEdge[13, 12] -> Cos[$CellContext`x], 
         DirectedEdge[7, 1] -> 1, DirectedEdge[9, 13] -> Sin[$CellContext`x], 
         DirectedEdge[10, 8] -> -Sin[$CellContext`x], 
         DirectedEdge[13, 9] -> -Sin[$CellContext`x], 
         DirectedEdge[15, 10] -> -1}, 
       EdgeStyle -> {
        DirectedEdge[6, 7] -> RGBColor[0.431296, 0.709773, 0.927077], 
         DirectedEdge[2, 3] -> RGBColor[0.431296, 0.709773, 0.927077], 
         DirectedEdge[10, 8] -> RGBColor[0.431296, 0.709773, 0.927077], 
         DirectedEdge[2, 6] -> RGBColor[0.431296, 0.709773, 0.927077], 
         DirectedEdge[15, 10] -> RGBColor[0.761959, 0.470832, 0.940597], 
         DirectedEdge[13, 9] -> RGBColor[0.431296, 0.709773, 0.927077], 
         DirectedEdge[8, 11] -> RGBColor[0.761959, 0.470832, 0.940597], 
         DirectedEdge[5, 2] -> RGBColor[0.431296, 0.709773, 0.927077], 
         DirectedEdge[13, 12] -> RGBColor[0.431296, 0.709773, 0.927077], 
         DirectedEdge[10, 13] -> RGBColor[0.431296, 0.709773, 0.927077], 
         DirectedEdge[7, 1] -> RGBColor[0.761959, 0.470832, 0.940597], 
         DirectedEdge[0, 0] -> RGBColor[0.761959, 0.470832, 0.940597], 
         DirectedEdge[1, 6] -> RGBColor[0.431296, 0.709773, 0.927077], 
         DirectedEdge[11, 14] -> RGBColor[0.761959, 0.470832, 0.940597], 
         DirectedEdge[9, 8] -> RGBColor[0.431296, 0.709773, 0.927077], 
         DirectedEdge[9, 13] -> RGBColor[0.431296, 0.709773, 0.927077], 
         DirectedEdge[12, 15] -> RGBColor[0.761959, 0.470832, 0.940597], 
         DirectedEdge[5, 7] -> RGBColor[0.431296, 0.709773, 0.927077], 
         DirectedEdge[14, 12] -> RGBColor[0.431296, 0.709773, 0.927077], 
         DirectedEdge[1, 3] -> RGBColor[0.431296, 0.709773, 0.927077], 
         DirectedEdge[3, 5] -> RGBColor[0.761959, 0.470832, 0.940597], 
         DirectedEdge[14, 9] -> RGBColor[0.431296, 0.709773, 0.927077], 
         DirectedEdge[4, 4] -> RGBColor[0.761959, 0.470832, 0.940597], 
         DirectedEdge[6, 2] -> RGBColor[0.431296, 0.709773, 0.927077]}, 
       VertexLabels -> {
        0 -> Subscript[QuEST`Gate`Id, 0] Subscript[QuEST`Gate`Id, 1], 9 -> 
         Subscript[QuEST`Gate`X, 0] Subscript[QuEST`Gate`Y, 1], 14 -> 
         Subscript[QuEST`Gate`Y, 0] Subscript[QuEST`Gate`Z, 1], 5 -> 
         Subscript[QuEST`Gate`X, 0] Subscript[QuEST`Gate`X, 1], 6 -> 
         Subscript[QuEST`Gate`X, 1] Subscript[QuEST`Gate`Y, 0], 13 -> 
         Subscript[QuEST`Gate`X, 0] Subscript[QuEST`Gate`Z, 1], 4 -> 
         Subscript[QuEST`Gate`Id, 0] Subscript[QuEST`Gate`X, 1], 15 -> 
         Subscript[QuEST`Gate`Z, 0] Subscript[QuEST`Gate`Z, 1], 12 -> 
         Subscript[QuEST`Gate`Id, 0] Subscript[QuEST`Gate`Z, 1], 8 -> 
         Subscript[QuEST`Gate`Id, 0] Subscript[QuEST`Gate`Y, 1], 7 -> 
         Subscript[QuEST`Gate`X, 1] Subscript[QuEST`Gate`Z, 0], 1 -> 
         Subscript[QuEST`Gate`Id, 1] Subscript[QuEST`Gate`X, 0], 10 -> 
         Subscript[QuEST`Gate`Y, 0] Subscript[QuEST`Gate`Y, 1], 2 -> 
         Subscript[QuEST`Gate`Id, 1] Subscript[QuEST`Gate`Y, 0], 3 -> 
         Subscript[QuEST`Gate`Id, 1] Subscript[QuEST`Gate`Z, 0], 11 -> 
         Subscript[QuEST`Gate`Y, 1] Subscript[QuEST`Gate`Z, 0]}, VertexStyle -> {
         GrayLevel[1]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], {
         {RGBColor[0.761959, 0.470832, 0.940597], 
          ArrowBox[BezierCurveBox[{{4.332543236723847, -0.8497226396476774}, {
           4.244063981256087, -1.0405061720329796`}, {
           4.045185503718495, -1.0969024144935737`}, {
           3.9180148792440384`, -1.0379453357187005`}, {
           3.9180148792440384`, -0.6614999435766542}, {
           4.045185503718495, -0.602542864801781}, {
           4.244063981256087, -0.658939107262375}, {
           4.332543236723847, -0.8497226396476774}},
           SplineDegree->7], 0.036895872238239105`]}, 
         InsetBox["1", {3.832543236723847, -0.8497226396476772}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.431296, 0.709773, 0.927077], 
          ArrowBox[{{2.042935216448903, -2.662190241220531}, {
           0.9198434548795635, -2.6088164362690476`}}, 
           0.036895872238239105`]}, InsetBox[
          RowBox[{"cos", "(", "x", ")"}], {1.4813893356642334, -2.6355033387447895},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.431296, 0.709773, 0.927077], 
          ArrowBox[{{2.042935216448903, -2.662190241220531}, {
           2.042077166307198, -3.7102177124841713`}}, 0.036895872238239105`]},
          InsetBox[
          RowBox[{"-", 
           RowBox[{"sin", "(", "x", ")"}]}], {2.0425061913780507, -3.186203976852351},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.761959, 0.470832, 0.940597], 
          ArrowBox[{{0.9198434548795635, -2.6088164362690476`}, {
           0.34972263964767736`, -3.185091380394349}}, 
           0.036895872238239105`]}, 
         InsetBox["1", {0.6347830472636204, -2.896953908331698}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.431296, 0.709773, 0.927077], 
          ArrowBox[BezierCurveBox[{{
           2.042077166307198, -3.7102177124841713`}, {
           1.4891357634311524`, -3.9215286378979415`}, {
           0.9187087902998579, -3.7633844930866704`}}], 
           0.036895872238239105`]}, InsetBox[
          RowBox[{"-", 
           RowBox[{"cos", "(", "x", ")"}]}], {1.4841146529457032, -3.8154368891059356},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.431296, 0.709773, 0.927077], 
          ArrowBox[{{2.042077166307198, -3.7102177124841713`}, {
           1.4815965000637132`, -3.1860901957166594`}}, 
           0.036895872238239105`]}, InsetBox[
          RowBox[{"-", 
           RowBox[{"sin", "(", "x", ")"}]}], {1.7618368331854557, -3.448153954100415},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.431296, 0.709773, 0.927077], 
          ArrowBox[{{0.9187087902998579, -3.7633844930866704`}, {
           0.9198434548795635, -2.6088164362690476`}}, 
           0.036895872238239105`]}, InsetBox[
          RowBox[{"-", 
           RowBox[{"sin", "(", "x", ")"}]}], {0.9192761225897107, -3.186100464677859},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.431296, 0.709773, 0.927077], 
          ArrowBox[BezierCurveBox[{{
           0.9187087902998579, -3.7633844930866704`}, {
           1.471650193175917, -3.5520735676728816`}, {
           2.042077166307198, -3.7102177124841713`}}], 
           0.036895872238239105`]}, InsetBox[
          RowBox[{"-", 
           RowBox[{"cos", "(", "x", ")"}]}], {1.476671303661353, -3.6581653164649075},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.431296, 0.709773, 0.927077], 
          ArrowBox[{{0.34972263964767736`, -3.185091380394349}, {
           0.9187087902998579, -3.7633844930866704`}}, 
           0.036895872238239105`]}, InsetBox[
          RowBox[{"-", 
           RowBox[{"sin", "(", "x", ")"}]}], {0.6342157149737676, -3.4742379367405096},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.431296, 0.709773, 0.927077], 
          ArrowBox[{{0.34972263964767736`, -3.185091380394349}, {
           1.4815965000637132`, -3.1860901957166594`}}, 
           0.036895872238239105`]}, InsetBox[
          RowBox[{"cos", "(", "x", ")"}], {0.9156595698556953, -3.185590788055504},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.761959, 0.470832, 0.940597], 
          ArrowBox[BezierCurveBox[{{4.332543236723847, -2.906276206014851}, {
           4.244063981256087, -3.0970597384001533`}, {
           4.045185503718495, -3.1534559808607474`}, {
           3.9180148792440384`, -3.094498902085874}, {
           3.9180148792440384`, -2.718053509943828}, {
           4.045185503718495, -2.6590964311689547`}, {
           4.244063981256087, -2.715492673629549}, {
           4.332543236723847, -2.906276206014851}},
           SplineDegree->7], 0.036895872238239105`]}, 
         InsetBox["1", {3.832543236723847, -2.906276206014851}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.761959, 0.470832, 0.940597], 
          ArrowBox[{{1.4815965000637132`, -3.1860901957166594`}, {
           2.042935216448903, -2.662190241220531}}, 0.036895872238239105`]}, 
         InsetBox["1", {1.7622658582563082, -2.924140218468595}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.761959, 0.470832, 0.940597], 
          ArrowBox[{{1.1308587938522643`, -0.3500196004075349}, {
           0.34972263964767736`, -1.1306058238963357`}}, 
           0.036895872238239105`]}, 
         InsetBox["1", {0.7402907167499708, -0.7403127121519353}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.761959, 0.470832, 0.940597], 
          ArrowBox[{{0.34972263964767736`, -1.1306058238963357`}, {
           1.1324441770459008`, -1.9091800083603345`}}, 
           0.036895872238239105`]}, 
         InsetBox["1", {0.7410834083467891, -1.519892916128335}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.431296, 0.709773, 0.927077], 
          ArrowBox[{{1.29241463509122, -1.1299428776037768`}, {
           1.1308587938522643`, -0.3500196004075349}}, 
           0.036895872238239105`]}, InsetBox[
          RowBox[{"cos", "(", "x", ")"}], {1.2116367144717421, -0.7399812390056558},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.431296, 0.709773, 0.927077], 
          ArrowBox[BezierCurveBox[{{1.29241463509122, -1.1299428776037768`}, {
           1.7415521904393236`, -0.9821866157613682}, {
           2.190715406322687, -1.1298648539518923`}}], 
           0.036895872238239105`]}, InsetBox[
          RowBox[{"sin", "(", "x", ")"}], {1.7415595590513215, -1.0670228117916318},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.431296, 0.709773, 0.927077], 
          ArrowBox[BezierCurveBox[{{
           2.190715406322687, -1.1298648539518923`}, {
           1.7415778509745754`, -1.2776211157943056`}, {
           1.29241463509122, -1.1299428776037768`}}], 0.036895872238239105`]},
          InsetBox[
          RowBox[{"-", 
           RowBox[{"sin", "(", "x", ")"}]}], {1.7415704823625853, -1.1927849197640374},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.431296, 0.709773, 0.927077], 
          ArrowBox[{{2.190715406322687, -1.1298648539518923`}, {
           2.352110094838154, -1.9093711569736929`}}, 0.036895872238239105`]},
          InsetBox[
          RowBox[{"cos", "(", "x", ")"}], {2.2714127505804207, -1.5196180054627926},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.431296, 0.709773, 0.927077], 
          ArrowBox[{{2.349671844773058, -0.34972263964767736`}, {
           1.1308587938522643`, -0.3500196004075349}}, 
           0.036895872238239105`]}, InsetBox[
          RowBox[{"-", 
           RowBox[{"sin", "(", "x", ")"}]}], {1.7402653193126612, -0.3498711200276061},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.431296, 0.709773, 0.927077], 
          ArrowBox[{{2.349671844773058, -0.34972263964767736`}, {
           2.190715406322687, -1.1298648539518923`}}, 0.036895872238239105`]},
          InsetBox[
          RowBox[{"cos", "(", "x", ")"}], {2.2701936255478725, -0.7397937467997848},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.431296, 0.709773, 0.927077], 
          ArrowBox[{{1.1324441770459008`, -1.9091800083603345`}, {
           1.29241463509122, -1.1299428776037768`}}, 0.036895872238239105`]}, 
         InsetBox[
          RowBox[{"-", 
           RowBox[{"cos", "(", "x", ")"}]}], {1.2124294060685603, -1.5195614429820556},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.431296, 0.709773, 0.927077], 
          ArrowBox[{{1.1324441770459008`, -1.9091800083603345`}, {
           2.352110094838154, -1.9093711569736929`}}, 0.036895872238239105`]},
          InsetBox[
          RowBox[{"-", 
           RowBox[{"sin", "(", "x", ")"}]}], {1.7422771359420275, -1.9092755826670138},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.761959, 0.470832, 0.940597], 
          ArrowBox[{{2.352110094838154, -1.9093711569736929`}, {
           3.133097957428492, -1.1284229279073104`}}, 0.036895872238239105`]},
          InsetBox["1", {2.742604026133323, -1.5188970424405017}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         {RGBColor[0.761959, 0.470832, 0.940597], 
          ArrowBox[{{3.133097957428492, -1.1284229279073104`}, {
           2.349671844773058, -0.34972263964767736`}}, 
           0.036895872238239105`]}, InsetBox[
          RowBox[{"-", "1"}], {2.741384901100775, -0.7390727837774939}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {
         DiskBox[{4.332543236723847, -0.8497226396476774}, 
          0.036895872238239105], InsetBox[
          RowBox[{
           SubscriptBox["Id", "0"], " ", 
           SubscriptBox["Id", "1"]}], 
          Offset[{2, 2}, {4.369439108962086, -0.8128267674094383}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{2.042935216448903, -2.662190241220531}, 
          0.036895872238239105], InsetBox[
          RowBox[{
           SubscriptBox["Id", "1"], " ", 
           SubscriptBox["X", "0"]}], 
          Offset[{2, 2}, {2.0798310886871425, -2.6252943689822916}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.9198434548795635, -2.6088164362690476}, 
          0.036895872238239105], InsetBox[
          RowBox[{
           SubscriptBox["Id", "1"], " ", 
           SubscriptBox["Z", "0"]}], 
          Offset[{2, 2}, {0.9567393271178026, -2.5719205640308083}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{2.042077166307198, -3.7102177124841713}, 
          0.036895872238239105], InsetBox[
          RowBox[{
           SubscriptBox["X", "1"], " ", 
           SubscriptBox["Y", "0"]}], 
          Offset[{2, 2}, {2.0789730385454375, -3.673321840245932}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.9187087902998579, -3.7633844930866704}, 
          0.036895872238239105], InsetBox[
          RowBox[{
           SubscriptBox["Id", "1"], " ", 
           SubscriptBox["Y", "0"]}], 
          Offset[{2, 2}, {0.955604662538097, -3.726488620848431}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.34972263964767736, -3.185091380394349}, 
          0.036895872238239105], InsetBox[
          RowBox[{
           SubscriptBox["X", "0"], " ", 
           SubscriptBox["X", "1"]}], 
          Offset[{2, 2}, {0.38661851188591645, -3.1481955081561095}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{4.332543236723847, -2.906276206014851}, 
          0.036895872238239105], InsetBox[
          RowBox[{
           SubscriptBox["Id", "0"], " ", 
           SubscriptBox["X", "1"]}], 
          Offset[{2, 2}, {4.369439108962086, -2.8693803337766117}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.4815965000637132, -3.1860901957166594}, 
          0.036895872238239105], InsetBox[
          RowBox[{
           SubscriptBox["X", "1"], " ", 
           SubscriptBox["Z", "0"]}], 
          Offset[{2, 2}, {1.5184923723019523, -3.14919432347842}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.1308587938522643, -0.3500196004075349}, 
          0.036895872238239105], InsetBox[
          RowBox[{
           SubscriptBox["Id", "0"], " ", 
           SubscriptBox["Y", "1"]}], 
          Offset[{2, 2}, {1.1677546660905034, -0.3131237281692958}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{0.34972263964767736, -1.1306058238963357}, 
          0.036895872238239105], InsetBox[
          RowBox[{
           SubscriptBox["Y", "1"], " ", 
           SubscriptBox["Z", "0"]}], 
          Offset[{2, 2}, {0.38661851188591645, -1.0937099516580966}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.29241463509122, -1.1299428776037768}, 
          0.036895872238239105], InsetBox[
          RowBox[{
           SubscriptBox["X", "0"], " ", 
           SubscriptBox["Y", "1"]}], 
          Offset[{2, 2}, {1.329310507329459, -1.0930470053655377}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{2.190715406322687, -1.1298648539518923}, 
          0.036895872238239105], InsetBox[
          RowBox[{
           SubscriptBox["X", "0"], " ", 
           SubscriptBox["Z", "1"]}], 
          Offset[{2, 2}, {2.2276112785609263, -1.0929689817136532}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{2.349671844773058, -0.34972263964767736}, 
          0.036895872238239105], InsetBox[
          RowBox[{
           SubscriptBox["Y", "0"], " ", 
           SubscriptBox["Y", "1"]}], 
          Offset[{2, 2}, {2.3865677170112973, -0.31282676740943827}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{1.1324441770459008, -1.9091800083603345}, 
          0.036895872238239105], InsetBox[
          RowBox[{
           SubscriptBox["Y", "0"], " ", 
           SubscriptBox["Z", "1"]}], 
          Offset[{2, 2}, {1.16934004928414, -1.8722841361220954}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{2.352110094838154, -1.9093711569736929}, 
          0.036895872238239105], InsetBox[
          RowBox[{
           SubscriptBox["Id", "0"], " ", 
           SubscriptBox["Z", "1"]}], 
          Offset[{2, 2}, {2.3890059670763932, -1.8724752847354538}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         DiskBox[{3.133097957428492, -1.1284229279073104}, 
          0.036895872238239105], InsetBox[
          RowBox[{
           SubscriptBox["Z", "0"], " ", 
           SubscriptBox["Z", "1"]}], 
          Offset[{2, 2}, {3.169993829666731, -1.0915270556690713}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{{3.9174519152028522`*^9, 3.917451995198167*^9}, 
   3.917452034586043*^9, {3.917452078586602*^9, 3.9174520868446217`*^9}, {
   3.917452124887361*^9, 3.917452154230504*^9}, 3.917452197089319*^9, {
   3.917452240357188*^9, 3.9174522654106894`*^9}, {3.917452409410787*^9, 
   3.9174525001885977`*^9}, {3.917453049516478*^9, 3.9174530526159573`*^9}, {
   3.917453174699645*^9, 3.917453232438211*^9}, {3.917453342864962*^9, 
   3.9174534258228083`*^9}, 3.917454225310288*^9, 3.9174542952236567`*^9, {
   3.91745453423775*^9, 3.917454563284504*^9}, 3.917456631254158*^9, 
   3.917457413396549*^9, 3.917457985095026*^9, 3.9174585929197283`*^9, {
   3.917458646597783*^9, 3.9174586963072853`*^9}, 3.917460005821741*^9, 
   3.917461144209161*^9, 3.917507028938574*^9, 3.917515231523415*^9, 
   3.9175163034895697`*^9, 3.9175166629961147`*^9, 3.917516864884962*^9, 
   3.917517876768662*^9, 3.9175184082695827`*^9, 3.9181123050441437`*^9, 
   3.920956146358494*^9, 3.921408304246541*^9, 3.921421733977703*^9, 
   3.9214809683259*^9, 3.9214821033259487`*^9, 3.921482147769332*^9},
 CellLabel->"Out[79]=",ExpressionUUID->"45d7f665-ec40-4a3c-8f2b-c6fdcdbda4b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox["X", "1"], 
    SubscriptBox["Z", "0"]}], ",", " ", "map"}], "]"}]], "Input",
 CellChangeTimes->{3.9174531187136*^9},
 CellLabel->"In[80]:=",ExpressionUUID->"b0f0c915-3d90-428b-9c6e-5d706e32165a"],

Cell[BoxData[
 SubscriptBox["X", "0"]], "Output",
 CellChangeTimes->{
  3.9174531190544367`*^9, {3.917453189775435*^9, 3.917453206089733*^9}, 
   3.917453238836151*^9, {3.91745334517416*^9, 3.917453441687667*^9}, {
   3.9174535219233017`*^9, 3.9174535300928497`*^9}, 3.917454227153264*^9, {
   3.917454534476717*^9, 3.91745456331047*^9}, 3.917456633479869*^9, 
   3.9174600080463343`*^9, 3.917507030469411*^9, 3.917515232293313*^9, 
   3.917516304012504*^9, 3.917516664197063*^9, 3.9175168649089403`*^9, 
   3.9175178774895067`*^9, 3.917518408982277*^9, 3.917518447452375*^9, {
   3.917518487939612*^9, 3.9175184968071833`*^9}, 3.918112306524921*^9, 
   3.920956146559574*^9, 3.9214083043604*^9, 3.92142173400219*^9, 
   3.9214809694965153`*^9, 3.921482109452145*^9, 3.921482147792726*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"2a2c0aec-2216-4084-8e08-b77690256392"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"a", " ", 
     SubscriptBox["X", "0"], 
     SubscriptBox["Z", "1"]}], " ", "+", " ", 
    RowBox[{"b", " ", 
     SubscriptBox["X", "1"]}], " ", "+", " ", 
    RowBox[{"c", " ", 
     SubscriptBox["X", "1"], 
     SubscriptBox["Z", "0"]}]}], ",", " ", "map"}], "]"}]], "Input",
 CellLabel->"In[81]:=",ExpressionUUID->"f9352ffb-345e-452e-921e-fcc508f30748"],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", " ", 
   SubscriptBox["X", "0"]}], "+", 
  RowBox[{"b", " ", 
   SubscriptBox["X", "1"]}], "-", 
  RowBox[{"a", " ", 
   RowBox[{"Sin", "[", "x", "]"}], " ", 
   SubscriptBox["X", "0"], " ", 
   SubscriptBox["Y", "1"]}], "+", 
  RowBox[{"a", " ", 
   RowBox[{"Cos", "[", "x", "]"}], " ", 
   SubscriptBox["Z", "1"]}]}]], "Output",
 CellChangeTimes->{
  3.917452501728819*^9, {3.9174530508456717`*^9, 3.917453053992408*^9}, {
   3.9174531885321712`*^9, 3.917453233712591*^9}, {3.917453347027017*^9, 
   3.9174534404219837`*^9}, 3.917453520697776*^9, 3.917453942914403*^9, {
   3.9174542003496*^9, 3.917454228255208*^9}, {3.917454534519415*^9, 
   3.9174545633595257`*^9}, 3.917456634896838*^9, 3.917457986033613*^9, 
   3.917458156853607*^9, 3.917460009319839*^9, 3.917507031681406*^9, 
   3.91751523333121*^9, 3.917516304159246*^9, 3.917516665623067*^9, 
   3.917516864940338*^9, 3.91751787849496*^9, 3.9175184981954536`*^9, 
   3.918112308169059*^9, 3.920956146571047*^9, 3.921408304367865*^9, 
   3.9214217340458937`*^9, 3.921480970782483*^9, 3.921482109646275*^9, 
   3.921482147820615*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"a3b61aee-083f-46b9-8d16-da8f0906e2cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"a", " ", 
     SubscriptBox["X", "0"], 
     SubscriptBox["Z", "1"]}], " ", "+", " ", 
    RowBox[{"b", " ", 
     SubscriptBox["X", "1"]}], " ", "+", " ", 
    RowBox[{"c", " ", 
     SubscriptBox["X", "1"], 
     SubscriptBox["Z", "0"]}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
    "map", ",", "map", ",", "map", ",", "map", ",", "map", ",", "map", ",", 
     " ", "map"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9174539356498213`*^9, 3.9174539907407017`*^9}, {
  3.917459353951787*^9, 3.9174593548380117`*^9}, {3.9174600558205442`*^9, 
  3.917460059668232*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"b9b6b16b-a31e-4949-bc33-edc7a5f79b1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", "c", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"3", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "x"}], "]"}]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "x", "]"}], "2"], " ", 
   SubscriptBox["X", "0"]}], "+", 
  RowBox[{"b", " ", 
   SubscriptBox["X", "1"]}], "+", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "x", "]"}], "5"], " ", 
   SubscriptBox["X", "0"], " ", 
   SubscriptBox["X", "1"]}], "+", 
  RowBox[{"c", " ", 
   RowBox[{"Cos", "[", "x", "]"}], " ", 
   RowBox[{"Sin", "[", "x", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"Cos", "[", "x", "]"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"Cos", "[", "x", "]"}], "4"], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "x", "]"}], "2"]}]}], ")"}], " ", 
   SubscriptBox["Y", "0"]}], "+", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "x", "]"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "x"}], "]"}]}]}], ")"}], " ", 
   RowBox[{"Sin", "[", "x", "]"}], " ", 
   SubscriptBox["X", "1"], " ", 
   SubscriptBox["Y", "0"]}], "+", 
  RowBox[{"a", " ", 
   RowBox[{"Sin", "[", "x", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"Cos", "[", "x", "]"}], "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "x", "]"}], "6"], "-", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "x"}], "]"}], "2"]}], ")"}], " ", 
   SubscriptBox["X", "0"], " ", 
   SubscriptBox["Y", "1"]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "a", " ", 
   RowBox[{"Cos", "[", "x", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"3", "-", 
     RowBox[{"12", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "x"}], "]"}]}], "+", 
     RowBox[{"Cos", "[", 
      RowBox[{"4", " ", "x"}], "]"}]}], ")"}], " ", 
   SubscriptBox["Y", "0"], " ", 
   SubscriptBox["Y", "1"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "c", " ", 
   RowBox[{"Sin", "[", "x", "]"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"4", " ", "x"}], "]"}], " ", 
   SubscriptBox["Z", "0"]}], "+", 
  RowBox[{"c", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "x", "]"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{"3", "+", 
     SuperscriptBox[
      RowBox[{"Cos", "[", "x", "]"}], "2"]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "x", "]"}], "2"], " ", 
   SubscriptBox["X", "1"], " ", 
   SubscriptBox["Z", "0"]}], "-", 
  RowBox[{
   FractionBox["1", "16"], " ", "a", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     RowBox[{"16", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "x"}], "]"}]}], "+", 
     RowBox[{"Cos", "[", 
      RowBox[{"4", " ", "x"}], "]"}]}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "x"}], "]"}], " ", 
   SubscriptBox["Y", "1"], " ", 
   SubscriptBox["Z", "0"]}], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", "a", " ", 
   RowBox[{"Cos", "[", "x", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"3", "-", 
     RowBox[{"20", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "x"}], "]"}]}], "+", 
     RowBox[{"Cos", "[", 
      RowBox[{"4", " ", "x"}], "]"}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "x", "]"}], "2"], " ", 
   SubscriptBox["Z", "1"]}]}]], "Output",
 CellChangeTimes->{{3.917453937920855*^9, 3.9174539911353617`*^9}, 
   3.917454198933056*^9, 3.917454229556137*^9, {3.917454534566804*^9, 
   3.917454563393841*^9}, 3.917456636397143*^9, 3.917457414240629*^9, {
   3.9174579872025127`*^9, 3.917458015913816*^9}, 3.91745815864894*^9, 
   3.917458700921907*^9, {3.917459349729644*^9, 3.917459355071506*^9}, 
   3.917459975306988*^9, {3.917460057221919*^9, 3.917460059913226*^9}, {
   3.9174605038398237`*^9, 3.917460506569315*^9}, 3.917507032835535*^9, 
   3.917515234560711*^9, 3.9175163052254457`*^9, 3.917516667292967*^9, 
   3.917516864991753*^9, 3.9175178797686977`*^9, 3.9175184993496103`*^9, 
   3.91811231011373*^9, 3.920956146917536*^9, 3.921408304535472*^9, 
   3.921421734202029*^9, 3.921480971792601*^9, 3.9214821098347273`*^9, 
   3.921482147879632*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"e77f81df-a5d8-4e63-a725-ddf566d76fff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"4", " ", "^", " ", "2"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", " ", "=", " ", 
   RowBox[{
    SubscriptBox["Z", "0"], "+", 
    SubscriptBox["Y", "1"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{"Length", " ", "@", " ", 
    RowBox[{"ApplyPauliTransferMap", "[", 
     RowBox[{"str", ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"map", ",", "reps"}], "]"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", "\t", 
   RowBox[{"{", 
    RowBox[{"reps", ",", "1", ",", "10"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9174600436176033`*^9, 3.917460098755002*^9}, {
  3.917460179069696*^9, 3.917460276621868*^9}, {3.917460346607806*^9, 
  3.917460390532221*^9}, {3.917460420846076*^9, 3.9174604746370487`*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"cc66c4e6-f6e0-43ac-949d-f5632a4f07ab"],

Cell[BoxData["16"], "Output",
 CellChangeTimes->{{3.9174600944523563`*^9, 3.917460119252994*^9}, {
   3.91746017767889*^9, 3.9174602103333406`*^9}, {3.9174602683231916`*^9, 
   3.917460276872353*^9}, {3.9174603480588083`*^9, 3.917460373576211*^9}, {
   3.917460414217537*^9, 3.917460487360366*^9}, 3.917507035502042*^9, 
   3.917515236205113*^9, 3.917516306760253*^9, 3.91751666918964*^9, 
   3.917516865004713*^9, 3.917517881087676*^9, 3.9175185007736187`*^9, 
   3.918112311700078*^9, 3.920956146930595*^9, 3.921408304543387*^9, 
   3.921421734337376*^9, 3.921480973589517*^9, 3.92148210984381*^9, 
   3.921482147890265*^9},
 CellLabel->"Out[83]=",ExpressionUUID->"ea5e0831-a3b9-4106-a4ba-60dffcb5fb34"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2", ",", "3", ",", "5", ",", "8", ",", "10", ",", "10", ",", "10", ",", 
   "10", ",", "10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{{3.9174600944523563`*^9, 3.917460119252994*^9}, {
   3.91746017767889*^9, 3.9174602103333406`*^9}, {3.9174602683231916`*^9, 
   3.917460276872353*^9}, {3.9174603480588083`*^9, 3.917460373576211*^9}, {
   3.917460414217537*^9, 3.917460487360366*^9}, 3.917507035502042*^9, 
   3.917515236205113*^9, 3.917516306760253*^9, 3.91751666918964*^9, 
   3.917516865004713*^9, 3.917517881087676*^9, 3.9175185007736187`*^9, 
   3.918112311700078*^9, 3.920956146930595*^9, 3.921408304543387*^9, 
   3.921421734337376*^9, 3.921480973589517*^9, 3.92148210984381*^9, 
   3.921482148144394*^9},
 CellLabel->"Out[85]=",ExpressionUUID->"140fe869-1700-4799-8378-9afa59bf2e4a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Circuits", "Section",
 CellChangeTimes->{{3.91746001775187*^9, 
  3.917460026325035*^9}},ExpressionUUID->"be433be5-a593-4f0e-94b5-\
06232378443c"],

Cell[CellGroupData[{

Cell["Test 1", "Subsection",
 CellChangeTimes->{{3.921481322620566*^9, 
  3.9214813231468477`*^9}},ExpressionUUID->"a52df5a1-befc-45d2-889b-\
4e9464b770af"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", " ", "=", " ", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", " ", "=", " ", 
   RowBox[{"GetKnownCircuit", "[", 
    RowBox[{"\"\<QFT\>\"", ",", " ", "n"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m", " ", "=", " ", 
    RowBox[{"CalcCircuitMatrix", "[", "u", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]in", " ", "=", " ", 
   RowBox[{"RandomComplex", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "-", "\[ImaginaryI]"}], ",", 
       RowBox[{"1", "+", "\[ImaginaryI]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "^", "n"}], ",", " ", 
       RowBox[{"2", "^", "n"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]out", " ", "=", " ", 
    RowBox[{"m", " ", ".", " ", "\[Rho]in", " ", ".", " ", 
     RowBox[{"ConjugateTranspose", "[", "m", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]in", " ", "=", " ", 
   RowBox[{"GetPauliString", "[", "\[Rho]in", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]out", " ", "=", " ", 
    RowBox[{"ApplyPauliTransferMap", "[", 
     RowBox[{"\[Sigma]in", ",", " ", "u"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalcPauliExpressionMatrix", "[", "\[Sigma]out", "]"}], " ", "-", 
    " ", "\[Rho]out"}], " ", "//", " ", "Abs"}], " ", "//", " ", 
  "Max"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Chop", "[", "%", "]"}], " ", "===", " ", "0"}]}], "Input",
 CellChangeTimes->{{3.917459740096459*^9, 3.917459817886847*^9}, {
  3.917459923533111*^9, 3.917459953681367*^9}, {3.917460560583748*^9, 
  3.9174607418227882`*^9}, {3.917460786430973*^9, 3.917460842807624*^9}, {
  3.917507061273583*^9, 3.9175070930871553`*^9}, {3.9214817631320343`*^9, 
  3.921481779512147*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"9b5a2ad9-abfb-455a-8b91-beb517e651e9"],

Cell[BoxData["6.661338147750939`*^-16"], "Output",
 CellChangeTimes->{{3.917460716773138*^9, 3.9174607421906767`*^9}, {
   3.917460791336006*^9, 3.917460846512599*^9}, 3.917507043008361*^9, 
   3.917507094741065*^9, 3.9175153263323593`*^9, 3.917516700004157*^9, 
   3.917516866608144*^9, 3.917517886780745*^9, 3.917518504638226*^9, 
   3.918112316833701*^9, 3.920956149686572*^9, 3.92140830913482*^9, 
   3.921421738974365*^9, 3.921480978486308*^9, {3.9214817530688047`*^9, 
   3.9214817819031963`*^9}, 3.921482112811894*^9, 3.921482150087242*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"d048aa56-3739-497f-95d8-a6e5308fe939"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.917460716773138*^9, 3.9174607421906767`*^9}, {
   3.917460791336006*^9, 3.917460846512599*^9}, 3.917507043008361*^9, 
   3.917507094741065*^9, 3.9175153263323593`*^9, 3.917516700004157*^9, 
   3.917516866608144*^9, 3.917517886780745*^9, 3.917518504638226*^9, 
   3.918112316833701*^9, 3.920956149686572*^9, 3.92140830913482*^9, 
   3.921421738974365*^9, 3.921480978486308*^9, {3.9214817530688047`*^9, 
   3.9214817819031963`*^9}, 3.921482112811894*^9, 3.921482150089096*^9},
 CellLabel->"Out[94]=",ExpressionUUID->"7fda764b-941d-41d2-b113-ceed1d94fd83"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test 2", "Subsection",
 CellChangeTimes->{{3.921481322620566*^9, 
  3.9214813278018227`*^9}},ExpressionUUID->"b9caf1a0-e756-4922-8998-\
5ad1b1a00964"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"circ", " ", "=", " ", 
   RowBox[{"Circuit", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["Damp", "0"], "[", "a", "]"}], 
     RowBox[{
      SubscriptBox["Deph", "1"], "[", "b", "]"}], 
     RowBox[{
      SubscriptBox["Deph", 
       RowBox[{"0", ",", "1"}]], "[", "c", "]"}], 
     RowBox[{
      SubscriptBox["Depol", "1"], "[", "d", "]"}], 
     RowBox[{
      SubscriptBox["Depol", 
       RowBox[{"1", ",", "0"}]], "[", "e", "]"}], 
     SubscriptBox["H", "0"], 
     SubscriptBox["Id", "1"], 
     RowBox[{
      SubscriptBox["KrausNonTP", "0"], "@", 
      RowBox[{"RandomComplex", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"\[ImaginaryI]", "+", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "2", ",", "2"}], "}"}]}], "]"}]}], 
     RowBox[{
      SubscriptBox["Matr", "0"], "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"c", ",", "d"}], "}"}]}], "}"}]}], 
     RowBox[{
      SubscriptBox["C", "0"], "@", 
      RowBox[{
       SubscriptBox["Ph", "1"], "[", "h", "]"}]}], 
     RowBox[{"R", "[", 
      RowBox[{"i", ",", 
       RowBox[{
        SubscriptBox["Y", "0"], 
        SubscriptBox["Z", "1"]}]}], "]"}], 
     RowBox[{
      SubscriptBox["Rx", "1"], "[", "x", "]"}], 
     RowBox[{
      SubscriptBox["C", "1"], "@", 
      RowBox[{
       SubscriptBox["Ry", "0"], "[", "y", "]"}]}], 
     RowBox[{
      SubscriptBox["Rz", 
       RowBox[{"0", ",", "1"}]], "[", "z", "]"}], 
     SubscriptBox["S", "0"], 
     SubscriptBox["T", "1"], 
     SubscriptBox["SWAP", 
      RowBox[{"0", ",", "1"}]], 
     RowBox[{
      SubscriptBox[
       RowBox[{"UNonNorm", " "}], "1"], " ", "@", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"c", ",", "d"}], "}"}]}], "}"}]}], 
     SubscriptBox["X", "0"], 
     SubscriptBox["Y", "1"], 
     SubscriptBox["Z", "0"]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DrawCircuit", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.921421778558426*^9, 3.921421781155953*^9}, {
  3.921421826995118*^9, 3.921421872322117*^9}, {3.921422813917809*^9, 
  3.92142299861158*^9}, {3.921481114429984*^9, 3.921481117212379*^9}, {
  3.921481398662528*^9, 3.921481401162736*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"c66ea149-29c9-4f27-b0f8-8251de6bd847"],

Cell[BoxData[
 GraphicsBox[
  {EdgeForm[GrayLevel[0]], FaceForm[GrayLevel[
   1]], {{LineBox[{{0, 0.5}, {1, 0.5}}], LineBox[{{0, 1.5}, {1, 1.5}}]}, {
     LineBox[{{1, 0.5}, {2, 0.5}}], LineBox[{{1, 1.5}, {2, 1.5}}]}, {
     LineBox[{{2, 0.5}, {3, 0.5}}], LineBox[{{2, 1.5}, {3, 1.5}}]}, {
     LineBox[{{3, 0.5}, {4, 0.5}}], LineBox[{{3, 1.5}, {4, 1.5}}]}, {
     LineBox[{{4, 0.5}, {5, 0.5}}], LineBox[{{4, 1.5}, {5, 1.5}}]}, {
     LineBox[{{5, 0.5}, {6, 0.5}}], LineBox[{{5, 1.5}, {6, 1.5}}]}, {
     LineBox[{{6, 0.5}, {7, 0.5}}], LineBox[{{6, 1.5}, {7, 1.5}}]}, {
     LineBox[{{7, 0.5}, {8, 0.5}}], LineBox[{{7, 1.5}, {8, 1.5}}]}, {
     LineBox[{{8, 0.5}, {9, 0.5}}], LineBox[{{8, 1.5}, {9, 1.5}}]}, {
     LineBox[{{9, 0.5}, {10, 0.5}}], LineBox[{{9, 1.5}, {10, 1.5}}]}, {
     LineBox[{{10, 0.5}, {11, 0.5}}], LineBox[{{10, 1.5}, {11, 1.5}}]}, {
     LineBox[{{11, 0.5}, {12, 0.5}}], LineBox[{{11, 1.5}, {12, 1.5}}]}, {
     LineBox[{{12, 0.5}, {13, 0.5}}], LineBox[{{12, 1.5}, {13, 1.5}}]}, {
     LineBox[{{13, 0.5}, {14, 0.5}}], LineBox[{{13, 1.5}, {14, 1.5}}]}, {
     LineBox[{{14, 0.5}, {15, 0.5}}], LineBox[{{14, 1.5}, {15, 1.5}}]}, {
     LineBox[{{15, 0.5}, {16, 0.5}}], LineBox[{{15, 1.5}, {16, 1.5}}]}}, {
    {EdgeForm[Dashing[{Small, Small}]], RectangleBox[{0.1, 0.1}, {0.9, 0.9}], 
     InsetBox["\<\"\[Gamma]\"\>", {0.5, 0.5}]}, 
    {EdgeForm[Dashing[{Small, Small}]], RectangleBox[{0.1, 1.1}, {0.9, 1.9}], 
     InsetBox["\<\"\[Phi]\"\>", {0.5, 1.5}]}, 
    {EdgeForm[Dashing[{Small, Small}]], RectangleBox[{1.1, 0.1}, {1.9, 1.9}], 
     InsetBox["\<\"\[Phi]\"\>", {1.5, 1.}]}, 
    {EdgeForm[Dashing[{Small, Small}]], RectangleBox[{2.1, 1.1}, {2.9, 1.9}], 
     InsetBox["\<\"\[CapitalDelta]\"\>", {2.5, 1.5}]}, 
    {EdgeForm[Dashing[{Small, Small}]], RectangleBox[{3.1, 0.1}, {3.9, 1.9}], 
     InsetBox["\<\"\[CapitalDelta]\"\>", {3.5, 1.}]}, {
     RectangleBox[{4.1, 0.1}, {4.9, 0.9}], 
     InsetBox["\<\"H\"\>", {4.5, 0.5}]}, {}, 
    {EdgeForm[Dashing[{Small, Small}]], RectangleBox[{5.1, 0.1}, {5.9, 0.9}], 
     InsetBox["\<\"\[Kappa]NTP\"\>", {5.5, 0.5}]}, {
     RectangleBox[{6.1, 0.1}, {6.9, 0.9}], 
     InsetBox["\<\"Matr\"\>", {6.5, 0.5}]}, {
     {FaceForm[GrayLevel[
      0]], {DiskBox[{7.5, 0.5}, 0.1], DiskBox[{7.5, 1.5}, 0.1]}, 
      LineBox[{{7.5, 0.5}, {7.5, 1.5}}]}, 
     InsetBox["\<\"\[Theta]\"\>", {7.75, 0.75}]}, {
     LineBox[{{8.5, 0.5}, {8.5, 1.5}}], {RectangleBox[{8.1, 0.1}, {8.9, 0.9}],
       InsetBox["\<\"Ry\"\>", {8.5, 0.5}]}, {
      RectangleBox[{8.1, 1.1}, {8.9, 1.9}], 
      InsetBox["\<\"Rz\"\>", {8.5, 1.5}]}}, {
     RectangleBox[{9.1, 1.1}, {9.9, 1.9}], 
     InsetBox["\<\"Rx\"\>", {9.5, 1.5}]}, {
     {FaceForm[GrayLevel[0]], DiskBox[{10.5, 1.5}, 0.1], 
      LineBox[{{10.5, 0.5}, {10.5, 1.5}}]}, {
      RectangleBox[{10.1, 0.1}, {10.9, 0.9}], 
      InsetBox["\<\"Ry\"\>", {10.5, 0.5}]}}, {
     LineBox[{{11.5, 0.5}, {11.5, 1.5}}], {
      RectangleBox[{11.1, 0.1}, {11.9, 0.9}], 
      InsetBox["\<\"Rz\"\>", {11.5, 0.5}]}, {
      RectangleBox[{11.1, 1.1}, {11.9, 1.9}], 
      InsetBox["\<\"Rz\"\>", {11.5, 1.5}]}}, {
     RectangleBox[{12.1, 0.1}, {12.9, 0.9}], 
     InsetBox["\<\"S\"\>", {12.5, 0.5}]}, {
     RectangleBox[{12.1, 1.1}, {12.9, 1.9}], 
     InsetBox["\<\"T\"\>", {12.5, 1.5}]}, {{{
       LineBox[{{13.4, 0.4}, {13.6, 0.6}}], 
       LineBox[{{13.6, 0.4}, {13.4, 0.6}}]}, {
       LineBox[{{13.4, 1.4}, {13.6, 1.6}}], 
       LineBox[{{13.6, 1.4}, {13.4, 1.6}}]}}, 
     LineBox[{{13.5, 0.5}, {13.5, 1.5}}]}, {
     RectangleBox[{14.1, 1.1}, {14.9, 1.9}], 
     InsetBox["\<\"UNonNorm\"\>", {14.5, 1.5}]}, {
     CircleBox[{14.5, 0.5}, 0.25], LineBox[{{14.5, 0.25}, {14.5, 0.75}}]}, {
     RectangleBox[{15.1, 1.1}, {15.9, 1.9}], 
     InsetBox["\<\"Y\"\>", {15.5, 1.5}]}, {
     RectangleBox[{15.1, 0.1}, {15.9, 0.9}], 
     InsetBox["\<\"Z\"\>", {15.5, 0.5}]}}},
  ImageSize->510,
  PlotRangePadding->None]], "Output",
 CellChangeTimes->{{3.92142299733333*^9, 3.92142299896937*^9}, 
   3.921470613805545*^9, 3.921470709404798*^9, 3.921480981827498*^9, 
   3.9214811174812202`*^9, 3.921481330380332*^9, 3.92148140221095*^9, 
   3.921481644251543*^9, 3.921481803816147*^9, 3.921482112892672*^9, 
   3.921482150160098*^9},
 CellLabel->"Out[97]=",ExpressionUUID->"08de363a-2d11-4ad4-8971-a9215ca12d9e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]in", " ", "=", " ", 
   RowBox[{
    SubscriptBox["X", "0"], "+", 
    RowBox[{"2", 
     SubscriptBox["Y", "0"]}], "+", 
    RowBox[{"3", 
     SubscriptBox["Y", "1"]}], "+", 
    RowBox[{"4", 
     SubscriptBox["Z", "1"]}]}]}], ";"}]], "Input",
 CellLabel->"In[98]:=",ExpressionUUID->"a8089472-2d7d-4be5-a4b1-eb23f61936a5"],

Cell[CellGroupData[{

Cell["real/valid", "Subsubsection",
 CellChangeTimes->{{3.921481353340919*^9, 
  3.921481371977263*^9}},ExpressionUUID->"704fc063-e71a-483d-938a-\
1edfcc421ec2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"subs", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "->", ".1"}], ",", 
     RowBox[{"b", "->", ".2"}], ",", 
     RowBox[{"c", "->", ".3"}], ",", 
     RowBox[{"d", "->", ".4"}], ",", 
     RowBox[{"e", "->", ".5"}], ",", 
     RowBox[{"f", "->", "6"}], ",", 
     RowBox[{"g", "->", "7"}], ",", 
     RowBox[{"h", "->", "8"}], ",", 
     RowBox[{"i", "->", "9"}], ",", 
     RowBox[{"x", "->", "\[Pi]"}], ",", 
     RowBox[{"y", "->", 
      RowBox[{"Exp", "[", 
       RowBox[{"-", "\[Pi]"}], "]"}]}], ",", 
     RowBox[{"z", "->", 
      RowBox[{"-", "1"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m", " ", "=", " ", 
    RowBox[{"CalcCircuitMatrix", "[", 
     RowBox[{"circ", " ", "/.", " ", "subs"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]in", " ", "=", " ", 
   RowBox[{"RandomComplex", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "-", "\[ImaginaryI]"}], ",", 
       RowBox[{"1", "+", "\[ImaginaryI]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "^", "n"}], ",", " ", 
       RowBox[{"2", "^", "n"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]out", " ", "=", " ", 
   RowBox[{"m", " ", ".", " ", 
    RowBox[{"Flatten", " ", "@", " ", 
     RowBox[{"Transpose", " ", "@", " ", "\[Rho]in"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]out", " ", "=", " ", 
    RowBox[{"Transpose", " ", "@", " ", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{"\[Rho]out", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2", "^", "n"}], ",", 
         RowBox[{"2", "^", "n"}]}], "}"}]}], "]"}]}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]in", " ", "=", " ", 
   RowBox[{"GetPauliString", "[", "\[Rho]in", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]out", " ", "=", " ", 
    RowBox[{"ApplyPauliTransferMap", "[", 
     RowBox[{"\[Sigma]in", ",", " ", 
      RowBox[{"circ", " ", "/.", " ", "subs"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalcPauliExpressionMatrix", "[", "\[Sigma]out", "]"}], " ", "-", 
    " ", "\[Rho]out"}], " ", "//", " ", "Abs"}], " ", "//", " ", 
  "Max"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Chop", "[", "%", "]"}], " ", "===", " ", "0"}]}], "Input",
 CellChangeTimes->{{3.921481217012499*^9, 3.921481299726884*^9}, {
  3.921481411956521*^9, 3.921481424188149*^9}, {3.9214817362106657`*^9, 
  3.921481744026108*^9}, {3.921481808472876*^9, 3.921481810848525*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"dcdfaba5-8ae8-4e22-832b-545c40681ef1"],

Cell[BoxData["2.355138688025663`*^-16"], "Output",
 CellChangeTimes->{
  3.921481744919015*^9, {3.921481807342857*^9, 3.921481811342664*^9}, 
   3.921482113330998*^9, 3.921482150505535*^9},
 CellLabel->
  "Out[106]=",ExpressionUUID->"51ff0ef6-122d-4a81-b1d7-2552ac3678bd"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.921481744919015*^9, {3.921481807342857*^9, 3.921481811342664*^9}, 
   3.921482113330998*^9, 3.921482150507388*^9},
 CellLabel->
  "Out[107]=",ExpressionUUID->"bd837c36-67e0-438e-8f1e-7c02bc5e776e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["complex/invalid", "Subsubsection",
 CellChangeTimes->{{3.921481353340919*^9, 3.921481371977263*^9}, {
  3.9214818194329042`*^9, 
  3.921481821194208*^9}},ExpressionUUID->"9e543dc8-93f2-4e1e-aeea-\
783b5bf33f1a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"subs", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}], " ", "+=", " ", 
   RowBox[{"3", "\[ImaginaryI]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m", " ", "=", " ", 
    RowBox[{"CalcCircuitMatrix", "[", 
     RowBox[{
      RowBox[{"circ", " ", "/.", " ", "subs"}], ",", " ", 
      RowBox[{"AssertValidChannels", "->", "False"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]in", " ", "=", " ", 
   RowBox[{"RandomComplex", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "-", "\[ImaginaryI]"}], ",", 
       RowBox[{"1", "+", "\[ImaginaryI]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "^", "n"}], ",", " ", 
       RowBox[{"2", "^", "n"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]out", " ", "=", " ", 
   RowBox[{"m", " ", ".", " ", 
    RowBox[{"Flatten", " ", "@", " ", 
     RowBox[{"Transpose", " ", "@", " ", "\[Rho]in"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]out", " ", "=", " ", 
    RowBox[{"Transpose", " ", "@", " ", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{"\[Rho]out", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2", "^", "n"}], ",", 
         RowBox[{"2", "^", "n"}]}], "}"}]}], "]"}]}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]in", " ", "=", " ", 
   RowBox[{"GetPauliString", "[", "\[Rho]in", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]out", " ", "=", " ", 
    RowBox[{"ApplyPauliTransferMap", "[", 
     RowBox[{"\[Sigma]in", ",", " ", 
      RowBox[{"circ", " ", "/.", " ", "subs"}], ",", " ", 
      RowBox[{"AssertValidChannels", "->", "False"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"err", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CalcPauliExpressionMatrix", "[", "\[Sigma]out", "]"}], " ", 
       "-", " ", "\[Rho]out"}], ")"}], " ", "/", " ", "\[Rho]out"}], " ", "//",
     " ", "Abs"}], " ", "//", " ", "Max"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Chop", "[", "%", "]"}], " ", "===", " ", "0"}]}], "Input",
 CellChangeTimes->{{3.921481217012499*^9, 3.921481299726884*^9}, {
  3.921481411956521*^9, 3.921481424188149*^9}, {3.9214817362106657`*^9, 
  3.921481744026108*^9}, {3.921481808472876*^9, 3.9214818308964777`*^9}, {
  3.921481877018433*^9, 3.9214819151999083`*^9}, {3.921482033120447*^9, 
  3.9214820822499523`*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"d3686214-0ec0-4f5e-b035-af9767c44778"],

Cell[BoxData["2.001535568489458`*^-15"], "Output",
 CellChangeTimes->{{3.921481890495232*^9, 3.921481915706106*^9}, 
   3.921482083023995*^9, 3.921482113664608*^9, 3.9214821508104143`*^9},
 CellLabel->
  "Out[115]=",ExpressionUUID->"753f1a92-966a-414d-bbf1-d2b9690c14b9"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.921481890495232*^9, 3.921481915706106*^9}, 
   3.921482083023995*^9, 3.921482113664608*^9, 3.921482150812749*^9},
 CellLabel->
  "Out[116]=",ExpressionUUID->"99224325-7db7-4c26-9bb4-d0c059a33db5"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fully-mixing channels", "Section",
 CellChangeTimes->{{3.91746001775187*^9, 3.917460026325035*^9}, {
  3.920956183428007*^9, 
  3.920956185296023*^9}},ExpressionUUID->"d511aed7-3357-4797-88d1-\
43dc0a7bfc96"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   SubscriptBox["X", "0"], ",", " ", 
   RowBox[{
    SubscriptBox["Deph", "0"], "[", ".4", "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   SubscriptBox["X", "0"], ",", " ", 
   RowBox[{
    SubscriptBox["Deph", "0"], "[", ".5", "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   SubscriptBox["X", "0"], ",", " ", 
   RowBox[{
    SubscriptBox["Deph", "0"], "[", ".6", "]"}], ",", " ", 
   RowBox[{"AssertValidChannels", "->", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9209561873159657`*^9, 3.920956210658267*^9}, {
  3.9209562574567547`*^9, 3.920956262545772*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"58b93675-da58-4ede-9231-b57778f18b10"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.20000000000000007`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
  SubscriptBox["X", "0"]}]], "Output",
 CellChangeTimes->{{3.920956194910901*^9, 3.92095621096066*^9}, 
   3.9209562627976627`*^9, 3.921408309183484*^9, 3.9214217390117807`*^9, 
   3.921482113675068*^9, 3.921482150821836*^9},
 CellLabel->
  "Out[117]=",ExpressionUUID->"881f4d07-1dfe-4b39-9fc8-03b1da4e73e5"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.920956194910901*^9, 3.92095621096066*^9}, 
   3.9209562627976627`*^9, 3.921408309183484*^9, 3.9214217390117807`*^9, 
   3.921482113675068*^9, 3.921482150823677*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"2d66e525-f5a5-4a2b-b85d-f4cc605febb0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "0.20000000000000007`"}], "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ")"}], " ", 
  SubscriptBox["X", "0"]}]], "Output",
 CellChangeTimes->{{3.920956194910901*^9, 3.92095621096066*^9}, 
   3.9209562627976627`*^9, 3.921408309183484*^9, 3.9214217390117807`*^9, 
   3.921482113675068*^9, 3.921482150853443*^9},
 CellLabel->
  "Out[119]=",ExpressionUUID->"4ffc5016-a465-41b2-b64f-28302d4c58f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   SubscriptBox["X", "0"], ",", " ", 
   RowBox[{
    SubscriptBox["Deph", 
     RowBox[{"0", ",", "1"}]], "[", 
    RowBox[{"3", "/", "4"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   SubscriptBox["X", "0"], ",", " ", 
   RowBox[{
    SubscriptBox["Depol", "0"], "[", 
    RowBox[{"3", "/", "4"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   SubscriptBox["X", "0"], ",", " ", 
   RowBox[{
    SubscriptBox["Depol", 
     RowBox[{"0", ",", "1"}]], "[", 
    RowBox[{"15", "/", "16"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.920956274307872*^9, 3.920956306310894*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"de6ce778-79ab-452a-8010-385ff3b5677d"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.920956280640526*^9, 3.9209563066563997`*^9}, 
   3.921408309214053*^9, 3.9214217390640287`*^9, 3.921482113743947*^9, 
   3.9214821508876677`*^9},
 CellLabel->
  "Out[120]=",ExpressionUUID->"3cbe2051-bb66-4f67-92d0-ba601f6610e8"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.920956280640526*^9, 3.9209563066563997`*^9}, 
   3.921408309214053*^9, 3.9214217390640287`*^9, 3.921482113743947*^9, 
   3.921482150889268*^9},
 CellLabel->
  "Out[121]=",ExpressionUUID->"6ed71808-bebb-4e15-8067-f314331bf3b2"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.920956280640526*^9, 3.9209563066563997`*^9}, 
   3.921408309214053*^9, 3.9214217390640287`*^9, 3.921482113743947*^9, 
   3.921482150890583*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"683720db-fd0d-43cb-b9e4-aff0531240e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   SubscriptBox["X", "0"], ",", " ", 
   RowBox[{
    SubscriptBox["Damp", "0"], "[", "1", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.920956313717255*^9, 3.920956318987383*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"5484a5d2-d63d-41c4-bcae-aaf4671c0cbd"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.9209563177496*^9, 3.92095631925294*^9}, 
   3.9214083092242613`*^9, 3.921421739073599*^9, 3.9214821137574263`*^9, 
   3.921482150898666*^9},
 CellLabel->
  "Out[123]=",ExpressionUUID->"13c07b12-ccfa-45fa-9014-67f44778be9f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Options", "Section",
 CellChangeTimes->{{3.91746001775187*^9, 3.917460026325035*^9}, {
  3.9175167761365967`*^9, 
  3.9175167767463913`*^9}},ExpressionUUID->"97df6472-d787-4f5a-8287-\
e61d2d52d187"],

Cell[CellGroupData[{

Cell["Caching", "Subsection",
 CellChangeTimes->{{3.917459393716526*^9, 
  3.9174593942976837`*^9}},ExpressionUUID->"4cf09147-19b7-4bc9-98fb-\
a74a6426f3a2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"circ", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["C", "0"], "[", 
      SubscriptBox["X", "1"], "]"}], ",", " ", "500"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", " ", "@", " ", 
  RowBox[{"ApplyPauliTransferMap", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", " ", 
      SubscriptBox["X", "0"], 
      SubscriptBox["Z", "1"]}], " ", "+", " ", 
     RowBox[{"b", " ", 
      SubscriptBox["X", "1"]}], " ", "+", " ", 
     RowBox[{"c", " ", 
      SubscriptBox["X", "1"], 
      SubscriptBox["Z", "0"]}], " ", "+", " ", 
     SubscriptBox["Y", "2"]}], ",", " ", "circ", ",", " ", 
    RowBox[{"\"\<CacheMaps\>\"", "->", "\"\<Never\>\""}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Timing", " ", "@", " ", 
  RowBox[{"ApplyPauliTransferMap", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", " ", 
      SubscriptBox["X", "0"], 
      SubscriptBox["Z", "1"]}], " ", "+", " ", 
     RowBox[{"b", " ", 
      SubscriptBox["X", "1"]}], " ", "+", " ", 
     RowBox[{"c", " ", 
      SubscriptBox["X", "1"], 
      SubscriptBox["Z", "0"]}], " ", "+", " ", 
     SubscriptBox["Y", "2"]}], ",", " ", "circ", ",", " ", 
    RowBox[{"\"\<CacheMaps\>\"", "->", "\"\<Forever\>\""}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{
  3.917459413590646*^9, {3.917459458831615*^9, 3.917459461318143*^9}, {
   3.917459529606936*^9, 3.917459532454756*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"65f79189-1c3f-4635-80d7-8bc7ade43f68"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.442197`", ",", 
   RowBox[{
    RowBox[{"b", " ", 
     SubscriptBox["X", "1"]}], "+", 
    SubscriptBox["Y", "2"], "+", 
    RowBox[{"c", " ", 
     SubscriptBox["X", "1"], " ", 
     SubscriptBox["Z", "0"]}], "+", 
    RowBox[{"a", " ", 
     SubscriptBox["X", "0"], " ", 
     SubscriptBox["Z", "1"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.917459407043494*^9, 3.917459417134858*^9}, 
   3.917459464964261*^9, 3.917459536053679*^9, 3.9175071013538017`*^9, 
   3.917515331124797*^9, 3.9175167048775806`*^9, 3.917516870907642*^9, 
   3.917517891188076*^9, 3.91751850822902*^9, 3.920956153248774*^9, 
   3.921408312617763*^9, 3.921421742533133*^9, 3.9214821182987013`*^9, 
   3.9214821554761457`*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"19c39d34-df40-44b1-b551-3e30c5eb2577"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.72076`", ",", 
   RowBox[{
    RowBox[{"b", " ", 
     SubscriptBox["X", "1"]}], "+", 
    SubscriptBox["Y", "2"], "+", 
    RowBox[{"c", " ", 
     SubscriptBox["X", "1"], " ", 
     SubscriptBox["Z", "0"]}], "+", 
    RowBox[{"a", " ", 
     SubscriptBox["X", "0"], " ", 
     SubscriptBox["Z", "1"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.917459407043494*^9, 3.917459417134858*^9}, 
   3.917459464964261*^9, 3.917459536053679*^9, 3.9175071013538017`*^9, 
   3.917515331124797*^9, 3.9175167048775806`*^9, 3.917516870907642*^9, 
   3.917517891188076*^9, 3.91751850822902*^9, 3.920956153248774*^9, 
   3.921408312617763*^9, 3.921421742533133*^9, 3.9214821182987013`*^9, 
   3.921482156217114*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"eeae6282-cc43-49f3-aabe-368283664c52"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ApplyPauliTransferMap", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", " ", 
      SubscriptBox["X", "0"], 
      SubscriptBox["Z", "1"]}], " ", "+", " ", 
     RowBox[{"b", " ", 
      SubscriptBox["X", "1"]}], " ", "+", " ", 
     RowBox[{"c", " ", 
      SubscriptBox["X", "1"], 
      SubscriptBox["Z", "0"]}], " ", "+", " ", 
     SubscriptBox["Y", "2"]}], ",", " ", "circ", ",", " ", 
    RowBox[{"\"\<CacheMaps\>\"", "->", "\"\<Forever\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DownValues", "[", "QuEST`Private`obtainCachedPTMap", "]"}], " ", "//",
    " ", "First"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplyPauliTransferMap", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", " ", 
      SubscriptBox["X", "0"], 
      SubscriptBox["Z", "1"]}], " ", "+", " ", 
     RowBox[{"b", " ", 
      SubscriptBox["X", "1"]}], " ", "+", " ", 
     RowBox[{"c", " ", 
      SubscriptBox["X", "1"], 
      SubscriptBox["Z", "0"]}], " ", "+", " ", 
     SubscriptBox["Y", "2"]}], ",", " ", "circ", ",", " ", 
    RowBox[{"\"\<CacheMaps\>\"", "->", "\"\<Never\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DownValues", "[", "QuEST`Private`obtainCachedPTMap", "]"}], " ", "//",
    " ", "First"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplyPauliTransferMap", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", " ", 
      SubscriptBox["X", "0"], 
      SubscriptBox["Z", "1"]}], " ", "+", " ", 
     RowBox[{"b", " ", 
      SubscriptBox["X", "1"]}], " ", "+", " ", 
     RowBox[{"c", " ", 
      SubscriptBox["X", "1"], 
      SubscriptBox["Z", "0"]}], " ", "+", " ", 
     SubscriptBox["Y", "2"]}], ",", " ", "circ", ",", " ", 
    RowBox[{"\"\<CacheMaps\>\"", "->", "\"\<UntilCallEnd\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DownValues", "[", "QuEST`Private`obtainCachedPTMap", "]"}], " ", "//",
   " ", "First"}]}], "Input",
 CellChangeTimes->{{3.917459545717206*^9, 3.917459608152986*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"bb5acbce-ae6f-4fda-9515-d95f2367d25e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HoldPattern", "[", 
   RowBox[{"QuEST`Private`obtainCachedPTMap", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["C", "1"], "[", 
       SubscriptBox["X", "0"], "]"}], "}"}], ",", 
     RowBox[{"\<\"CacheMaps\"\>", "\[Rule]", "\<\"Forever\"\>"}]}], "]"}], 
   "]"}], "\[RuleDelayed]", 
  RowBox[{
   SubscriptBox["PTMap", 
    RowBox[{"0", ",", "1"}]], "[", 
   RowBox[{
    RowBox[{"0", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "}"}]}], ",", 
    RowBox[{"1", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "}"}]}], ",", 
    RowBox[{"2", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"14", ",", "1"}], "}"}], "}"}]}], ",", 
    RowBox[{"3", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"15", ",", "1"}], "}"}], "}"}]}], ",", 
    RowBox[{"4", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"5", ",", "1"}], "}"}], "}"}]}], ",", 
    RowBox[{"5", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"4", ",", "1"}], "}"}], "}"}]}], ",", 
    RowBox[{"6", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"11", ",", "1"}], "}"}], "}"}]}], ",", 
    RowBox[{"7", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"10", ",", 
        RowBox[{"-", "1"}]}], "}"}], "}"}]}], ",", 
    RowBox[{"8", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"9", ",", "1"}], "}"}], "}"}]}], ",", 
    RowBox[{"9", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"8", ",", "1"}], "}"}], "}"}]}], ",", 
    RowBox[{"10", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"7", ",", 
        RowBox[{"-", "1"}]}], "}"}], "}"}]}], ",", 
    RowBox[{"11", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"6", ",", "1"}], "}"}], "}"}]}], ",", 
    RowBox[{"12", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"12", ",", "1"}], "}"}], "}"}]}], ",", 
    RowBox[{"13", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"13", ",", "1"}], "}"}], "}"}]}], ",", 
    RowBox[{"14", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}], "}"}]}], ",", 
    RowBox[{"15", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"3", ",", "1"}], "}"}], "}"}]}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.917459547832879*^9, 3.917459608774901*^9}, 
   3.917507102216659*^9, 3.917515332017851*^9, 3.917516705814657*^9, 
   3.917516872122065*^9, 3.917517892589231*^9, 3.9175185092574863`*^9, 
   3.9209561544109297`*^9, 3.9214083136553383`*^9, 3.921421743566147*^9, 
   3.921482119930255*^9, 3.9214821570211678`*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"c5f5a0b1-e3b3-4738-9dbd-094baf3e7bdd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HoldPattern", "[", 
   RowBox[{"QuEST`Private`obtainCachedPTMap", "[", 
    RowBox[{"QuEST`Private`compGate_", ",", "QuEST`Private`opts___"}], "]"}], 
   "]"}], "\[RuleDelayed]", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"QuEST`Private`obtainCachedPTMap", "[", 
     RowBox[{"QuEST`Private`compGate", ",", "QuEST`Private`opts"}], "]"}], 
    "=", 
    RowBox[{"CalcPauliTransferMap", "[", 
     RowBox[{"QuEST`Private`compGate", ",", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "QuEST`Private`opts", "}"}], ",", 
         RowBox[{"Options", "[", "CalcPauliTransferMap", "]"}]}], "]"}]}]}], 
     "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.917459547832879*^9, 3.917459608774901*^9}, 
   3.917507102216659*^9, 3.917515332017851*^9, 3.917516705814657*^9, 
   3.917516872122065*^9, 3.917517892589231*^9, 3.9175185092574863`*^9, 
   3.9209561544109297`*^9, 3.9214083136553383`*^9, 3.921421743566147*^9, 
   3.921482119930255*^9, 3.921482161626248*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"fe7eda8e-fae9-4a0f-a8fe-5b1fbea5fc70"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HoldPattern", "[", 
   RowBox[{"QuEST`Private`obtainCachedPTMap", "[", 
    RowBox[{"QuEST`Private`compGate_", ",", "QuEST`Private`opts___"}], "]"}], 
   "]"}], "\[RuleDelayed]", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"QuEST`Private`obtainCachedPTMap", "[", 
     RowBox[{"QuEST`Private`compGate", ",", "QuEST`Private`opts"}], "]"}], 
    "=", 
    RowBox[{"CalcPauliTransferMap", "[", 
     RowBox[{"QuEST`Private`compGate", ",", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "QuEST`Private`opts", "}"}], ",", 
         RowBox[{"Options", "[", "CalcPauliTransferMap", "]"}]}], "]"}]}]}], 
     "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.917459547832879*^9, 3.917459608774901*^9}, 
   3.917507102216659*^9, 3.917515332017851*^9, 3.917516705814657*^9, 
   3.917516872122065*^9, 3.917517892589231*^9, 3.9175185092574863`*^9, 
   3.9209561544109297`*^9, 3.9214083136553383`*^9, 3.921421743566147*^9, 
   3.921482119930255*^9, 3.921482162306851*^9},
 CellLabel->
  "Out[132]=",ExpressionUUID->"1ed897d5-1daf-4095-9491-be5e025da615"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["AssertValidChannels", "Subsection",
 CellChangeTimes->{{3.917459393716526*^9, 3.9174593942976837`*^9}, {
  3.917516788627759*^9, 
  3.917516790712275*^9}},ExpressionUUID->"4bbd4d88-d588-49ff-9cc7-\
972de201b1c6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox["X", "0"], 
    SubscriptBox["Y", "1"]}], ",", " ", 
   RowBox[{
    SubscriptBox["Depol", 
     RowBox[{"0", ",", "1"}]], "[", "x", "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox["X", "0"], 
    SubscriptBox["Y", "1"]}], ",", " ", 
   RowBox[{
    SubscriptBox["Depol", 
     RowBox[{"0", ",", "1"}]], "[", "x", "]"}], ",", " ", 
   RowBox[{"AssertValidChannels", "->", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.917516964124177*^9, 3.917516989115457*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"a2fb38da-aa8a-47b2-bbe4-58e580d9a788"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "15"], " ", 
  RowBox[{"(", 
   RowBox[{"15", "-", 
    RowBox[{"16", " ", "x"}]}], ")"}], " ", 
  SubscriptBox["X", "0"], " ", 
  SubscriptBox["Y", "1"]}]], "Output",
 CellChangeTimes->{{3.917516976646902*^9, 3.917516989381826*^9}, 
   3.91751789663098*^9, 3.917518513274592*^9, 3.9209561587363367`*^9, 
   3.9214083178449917`*^9, 3.921421747601955*^9, 3.921482125794355*^9, 
   3.921482162386397*^9},
 CellLabel->
  "Out[133]=",ExpressionUUID->"2fa03b98-c74d-45ac-a155-88ac38115342"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "15"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"15", " ", 
     SqrtBox[
      RowBox[{"1", "-", "x"}]], " ", 
     RowBox[{"Conjugate", "[", 
      SqrtBox[
       RowBox[{"1", "-", "x"}]], "]"}]}], "-", 
    RowBox[{
     SqrtBox["x"], " ", 
     RowBox[{"Conjugate", "[", 
      SqrtBox["x"], "]"}]}]}], ")"}], " ", 
  SubscriptBox["X", "0"], " ", 
  SubscriptBox["Y", "1"]}]], "Output",
 CellChangeTimes->{{3.917516976646902*^9, 3.917516989381826*^9}, 
   3.91751789663098*^9, 3.917518513274592*^9, 3.9209561587363367`*^9, 
   3.9214083178449917`*^9, 3.921421747601955*^9, 3.921482125794355*^9, 
   3.9214821624240313`*^9},
 CellLabel->
  "Out[134]=",ExpressionUUID->"219d6378-40ed-4f34-8655-fa461f4db53e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Errors", "Chapter",
 CellChangeTimes->{{3.912849421029387*^9, 3.912849426146103*^9}, {
  3.912849785066738*^9, 3.912849790979604*^9}, {3.912878442788628*^9, 
  3.912878443004286*^9}, {3.9151991784358664`*^9, 3.9151991786465263`*^9}, {
  3.9173418805860863`*^9, 3.917341881626457*^9}, {3.917451715663147*^9, 
  3.9174517252876453`*^9}},ExpressionUUID->"5524d7f6-8b97-42e4-861f-\
3caad3568fb8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   SubscriptBox["X", "0"], ",", " ", 
   RowBox[{
    SubscriptBox["Deph", "0"], "[", ".6", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.920956242966518*^9, 3.920956249499556*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"189cd6f5-3fa7-454e-9d2f-9740c605f59a"],

Cell[BoxData[
 TemplateBox[{
  "ApplyPauliTransferMap", "error", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"Could not pre-compute the Pauli transfer \
maps due to the below error:\\\\\\\"\\\"}]\\)\"", 2, 135, 15, 
   32463720414734710359, "Local", "QuEST`ApplyPauliTransferMap"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.9209562497560177`*^9, 3.921408318136159*^9, 
  3.9214217478969507`*^9, 3.9214821262123528`*^9, 3.921482162471224*^9},
 CellLabel->
  "During evaluation of \
In[135]:=",ExpressionUUID->"dcfed6fb-88d6-461e-b74c-0db5bce69f50"],

Cell[BoxData[
 TemplateBox[{
  "CalcPauliTransferMatrix", "error", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"One or more channels could not be asserted \
as completely positive and trace-preserving (CPTP) and ergo could not be \
simplified. Prevent this error with AssertValidChannels -> \
False.\\\\\\\"\\\"}]\\)\"", 2, 135, 16, 32463720414734710359, "Local", 
   "QuEST`CalcPauliTransferMatrix"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.9209562497560177`*^9, 3.921408318136159*^9, 
  3.9214217478969507`*^9, 3.9214821262123528`*^9, 3.921482162479636*^9},
 CellLabel->
  "During evaluation of \
In[135]:=",ExpressionUUID->"2fe503b3-bea2-4417-b83b-eb72455bdb79"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{{3.920956237099985*^9, 3.920956249772935*^9}, 
   3.921408318150074*^9, 3.921421747910686*^9, 3.9214821262316093`*^9, 
   3.921482162488982*^9},
 CellLabel->
  "Out[135]=",ExpressionUUID->"41c1462a-3557-4e65-9817-28cda586d505"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   SubscriptBox["X", "0"], ",", " ", 
   RowBox[{"{", 
    SubscriptBox["blob", "0"], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.917460876952343*^9, 3.917460880917201*^9}, {
  3.917461150937204*^9, 3.917461187659659*^9}, {3.917461261034843*^9, 
  3.917461281555908*^9}, {3.918112324508513*^9, 3.918112325187296*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"ad62fa39-7002-46c3-8a53-8db709830815"],

Cell[BoxData[
 TemplateBox[{
  "ApplyPauliTransferMap", "error", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"Could not pre-compute the Pauli transfer \
maps due to the below error:\\\\\\\"\\\"}]\\)\"", 2, 136, 17, 
   32463720414734710359, "Local", "QuEST`ApplyPauliTransferMap"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{
  3.917461188073743*^9, {3.9174612631969624`*^9, 3.917461282087612*^9}, 
   3.917461339124713*^9, 3.917507108844516*^9, 3.917515339925696*^9, 
   3.917515772183557*^9, 3.9175158086916447`*^9, 3.917516721710568*^9, 
   3.917516876611145*^9, 3.91751789700596*^9, 3.917518516168346*^9, 
   3.918112326234578*^9, 3.920956159014847*^9, 3.921408318156098*^9, 
   3.9214217479175797`*^9, 3.9214821262398577`*^9, 3.921482162522685*^9},
 CellLabel->
  "During evaluation of \
In[136]:=",ExpressionUUID->"b58318d4-80b5-49b1-add5-e0c12a0fccb2"],

Cell[BoxData[
 TemplateBox[{
  "CalcPauliTransferMatrix", "error", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"Cannot obtain conjugate of unrecognised or \
unsupported operator: \
\\\\\\\\!\\\\\\\\(\\\\\\\\*SubscriptBox[\\\\\\\\\\\\\\\"blob\\\\\\\\\\\\\\\", \
\\\\\\\\\\\\\\\"0\\\\\\\\\\\\\\\"]\\\\\\\\)\\\\\\\"\\\"}]\\)\"", 2, 136, 18, 
   32463720414734710359, "Local", "QuEST`CalcPauliTransferMatrix"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{
  3.917461188073743*^9, {3.9174612631969624`*^9, 3.917461282087612*^9}, 
   3.917461339124713*^9, 3.917507108844516*^9, 3.917515339925696*^9, 
   3.917515772183557*^9, 3.9175158086916447`*^9, 3.917516721710568*^9, 
   3.917516876611145*^9, 3.91751789700596*^9, 3.917518516168346*^9, 
   3.918112326234578*^9, 3.920956159014847*^9, 3.921408318156098*^9, 
   3.9214217479175797`*^9, 3.9214821262398577`*^9, 3.92148216253202*^9},
 CellLabel->
  "During evaluation of \
In[136]:=",ExpressionUUID->"fab2bcd6-2b33-4c17-873d-92482710c1b3"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{{3.9174608779756927`*^9, 3.917460881147822*^9}, 
   3.917461108522272*^9, {3.917461147699191*^9, 3.91746118832498*^9}, {
   3.917461263220297*^9, 3.9174612821067257`*^9}, 3.9174613391446733`*^9, 
   3.9175071088661346`*^9, 3.917515339942129*^9, 3.91751577223343*^9, 
   3.917515808734118*^9, 3.917516721728702*^9, 3.9175168766292343`*^9, 
   3.917517897023177*^9, 3.91751851618517*^9, 3.918112326260564*^9, 
   3.920956159030162*^9, 3.921408318169725*^9, 3.9214217479317827`*^9, 
   3.92148212625677*^9, 3.921482162540967*^9},
 CellLabel->
  "Out[136]=",ExpressionUUID->"45da8d55-3260-4ea4-bdcd-8788edfb6043"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   SubscriptBox["X", "0"], ",", " ", 
   SubscriptBox["X", "0"], ",", " ", 
   RowBox[{"\"\<CacheMaps\>\"", "->", "\"\<Spaghetti\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   SubscriptBox["X", "0"], ",", " ", 
   RowBox[{"{", 
    SubscriptBox["X", "0"], "}"}], ",", " ", 
   RowBox[{"\"\<CacheMaps\>\"", "->", "\"\<Spaghetti\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   SubscriptBox["X", "0"], ",", " ", 
   RowBox[{
    SubscriptBox["PTM", "0"], "[", "x", "]"}], ",", " ", 
   RowBox[{"\"\<CacheMaps\>\"", "->", "\"\<Spaghetti\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   SubscriptBox["X", "0"], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["PTM", "0"], "[", "x", "]"}], "}"}], ",", " ", 
   RowBox[{"\"\<CacheMaps\>\"", "->", "\"\<Spaghetti\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   SubscriptBox["X", "0"], ",", " ", 
   RowBox[{
    SubscriptBox["PTMap", "0"], "[", "x", "]"}], ",", " ", 
   RowBox[{"\"\<CacheMaps\>\"", "->", "\"\<Spaghetti\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   SubscriptBox["X", "0"], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["PTMap", "0"], "[", "x", "]"}], "}"}], ",", " ", 
   RowBox[{"\"\<CacheMaps\>\"", "->", "\"\<Spaghetti\>\""}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9174587485848503`*^9, 3.917458758040655*^9}, {
  3.917516908522738*^9, 3.917516942514306*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"830f3f61-dea7-4f53-9f6b-d7ac57b1de9f"],

Cell[BoxData[
 TemplateBox[{
  "ApplyPauliTransferMap", "error", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"Option \\\\\\\\\\\\\\\"CacheMaps\\\\\\\\\\\
\\\\\" must be one of \\\\\\\\\\\\\\\"Forever\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\
\"UntilCallEnd\\\\\\\\\\\\\\\" or \\\\\\\\\\\\\\\"Never\\\\\\\\\\\\\\\". See \
?ApplyPauliTransferMap.\\\\\\\"\\\"}]\\)\"", 2, 137, 19, 32463720414734710359,
    "Local", "QuEST`ApplyPauliTransferMap"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{{3.917458751257202*^9, 3.917458758224103*^9}, 
   3.9174608690750732`*^9, 3.917461181608604*^9, 3.9175071102211723`*^9, 
   3.917515344659976*^9, 3.917515810993991*^9, 3.917516728154141*^9, 
   3.917516876659955*^9, {3.917516913515593*^9, 3.917516942751635*^9}, 
   3.917517897170616*^9, 3.917518517252955*^9, 3.918112328879951*^9, 
   3.920956159040224*^9, 3.921408318201921*^9, 3.921421747957321*^9, 
   3.9214821262923203`*^9, 3.9214821625512257`*^9},
 CellLabel->
  "During evaluation of \
In[137]:=",ExpressionUUID->"cc63ac0e-18b2-4a6d-84ea-443e786fc015"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{{3.917458751269355*^9, 3.917458758234292*^9}, 
   3.9174608690881968`*^9, 3.917461181635681*^9, 3.917507110236259*^9, 
   3.917515344669443*^9, 3.917515811003214*^9, 3.91751672816315*^9, 
   3.917516876670767*^9, {3.917516913526849*^9, 3.917516942764234*^9}, 
   3.9175178971820087`*^9, 3.9175185172615213`*^9, 3.9181123289280767`*^9, 
   3.920956159048543*^9, 3.921408318210622*^9, 3.92142174796489*^9, 
   3.921482126303337*^9, 3.921482162559348*^9},
 CellLabel->
  "Out[137]=",ExpressionUUID->"5a351e56-ca04-475b-a9ea-47169c8e67ad"],

Cell[BoxData[
 TemplateBox[{
  "ApplyPauliTransferMap", "error", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"Option \\\\\\\\\\\\\\\"CacheMaps\\\\\\\\\\\
\\\\\" must be one of \\\\\\\\\\\\\\\"Forever\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\
\"UntilCallEnd\\\\\\\\\\\\\\\" or \\\\\\\\\\\\\\\"Never\\\\\\\\\\\\\\\". See \
?ApplyPauliTransferMap.\\\\\\\"\\\"}]\\)\"", 2, 138, 20, 32463720414734710359,
    "Local", "QuEST`ApplyPauliTransferMap"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{{3.917458751257202*^9, 3.917458758224103*^9}, 
   3.9174608690750732`*^9, 3.917461181608604*^9, 3.9175071102211723`*^9, 
   3.917515344659976*^9, 3.917515810993991*^9, 3.917516728154141*^9, 
   3.917516876659955*^9, {3.917516913515593*^9, 3.917516942751635*^9}, 
   3.917517897170616*^9, 3.917518517252955*^9, 3.918112328879951*^9, 
   3.920956159040224*^9, 3.921408318201921*^9, 3.921421747957321*^9, 
   3.9214821262923203`*^9, 3.921482162560812*^9},
 CellLabel->
  "During evaluation of \
In[137]:=",ExpressionUUID->"367a16fd-40dc-4707-950d-d63bbb10609d"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{{3.917458751269355*^9, 3.917458758234292*^9}, 
   3.9174608690881968`*^9, 3.917461181635681*^9, 3.917507110236259*^9, 
   3.917515344669443*^9, 3.917515811003214*^9, 3.91751672816315*^9, 
   3.917516876670767*^9, {3.917516913526849*^9, 3.917516942764234*^9}, 
   3.9175178971820087`*^9, 3.9175185172615213`*^9, 3.9181123289280767`*^9, 
   3.920956159048543*^9, 3.921408318210622*^9, 3.92142174796489*^9, 
   3.921482126303337*^9, 3.921482162569169*^9},
 CellLabel->
  "Out[138]=",ExpressionUUID->"5f0c5ee0-db8f-450e-b938-ae6efad06a21"],

Cell[BoxData[
 TemplateBox[{
  "ApplyPauliTransferMap", "error", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"Option \\\\\\\\\\\\\\\"CacheMaps\\\\\\\\\\\
\\\\\" must be one of \\\\\\\\\\\\\\\"Forever\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\
\"UntilCallEnd\\\\\\\\\\\\\\\" or \\\\\\\\\\\\\\\"Never\\\\\\\\\\\\\\\". See \
?ApplyPauliTransferMap.\\\\\\\"\\\"}]\\)\"", 2, 139, 21, 32463720414734710359,
    "Local", "QuEST`ApplyPauliTransferMap"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{{3.917458751257202*^9, 3.917458758224103*^9}, 
   3.9174608690750732`*^9, 3.917461181608604*^9, 3.9175071102211723`*^9, 
   3.917515344659976*^9, 3.917515810993991*^9, 3.917516728154141*^9, 
   3.917516876659955*^9, {3.917516913515593*^9, 3.917516942751635*^9}, 
   3.917517897170616*^9, 3.917518517252955*^9, 3.918112328879951*^9, 
   3.920956159040224*^9, 3.921408318201921*^9, 3.921421747957321*^9, 
   3.9214821262923203`*^9, 3.921482162570599*^9},
 CellLabel->
  "During evaluation of \
In[137]:=",ExpressionUUID->"02bec6ff-0db5-4942-8dc6-2475b729811d"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{{3.917458751269355*^9, 3.917458758234292*^9}, 
   3.9174608690881968`*^9, 3.917461181635681*^9, 3.917507110236259*^9, 
   3.917515344669443*^9, 3.917515811003214*^9, 3.91751672816315*^9, 
   3.917516876670767*^9, {3.917516913526849*^9, 3.917516942764234*^9}, 
   3.9175178971820087`*^9, 3.9175185172615213`*^9, 3.9181123289280767`*^9, 
   3.920956159048543*^9, 3.921408318210622*^9, 3.92142174796489*^9, 
   3.921482126303337*^9, 3.9214821625782757`*^9},
 CellLabel->
  "Out[139]=",ExpressionUUID->"07b1325c-d101-4e3a-b8bf-352578e84b10"],

Cell[BoxData[
 TemplateBox[{
  "ApplyPauliTransferMap", "error", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"Option \\\\\\\\\\\\\\\"CacheMaps\\\\\\\\\\\
\\\\\" must be one of \\\\\\\\\\\\\\\"Forever\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\
\"UntilCallEnd\\\\\\\\\\\\\\\" or \\\\\\\\\\\\\\\"Never\\\\\\\\\\\\\\\". See \
?ApplyPauliTransferMap.\\\\\\\"\\\"}]\\)\"", 2, 140, 22, 32463720414734710359,
    "Local", "QuEST`ApplyPauliTransferMap"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{{3.917458751257202*^9, 3.917458758224103*^9}, 
   3.9174608690750732`*^9, 3.917461181608604*^9, 3.9175071102211723`*^9, 
   3.917515344659976*^9, 3.917515810993991*^9, 3.917516728154141*^9, 
   3.917516876659955*^9, {3.917516913515593*^9, 3.917516942751635*^9}, 
   3.917517897170616*^9, 3.917518517252955*^9, 3.918112328879951*^9, 
   3.920956159040224*^9, 3.921408318201921*^9, 3.921421747957321*^9, 
   3.9214821262923203`*^9, 3.921482162580379*^9},
 CellLabel->
  "During evaluation of \
In[137]:=",ExpressionUUID->"3905d76c-2cda-42bf-ac95-541666ad8fb5"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{{3.917458751269355*^9, 3.917458758234292*^9}, 
   3.9174608690881968`*^9, 3.917461181635681*^9, 3.917507110236259*^9, 
   3.917515344669443*^9, 3.917515811003214*^9, 3.91751672816315*^9, 
   3.917516876670767*^9, {3.917516913526849*^9, 3.917516942764234*^9}, 
   3.9175178971820087`*^9, 3.9175185172615213`*^9, 3.9181123289280767`*^9, 
   3.920956159048543*^9, 3.921408318210622*^9, 3.92142174796489*^9, 
   3.921482126303337*^9, 3.921482162588011*^9},
 CellLabel->
  "Out[140]=",ExpressionUUID->"ce94b8c7-da53-4394-991e-4d0e6ea15b8a"],

Cell[BoxData[
 TemplateBox[{
  "ApplyPauliTransferMap", "error", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"Option \\\\\\\\\\\\\\\"CacheMaps\\\\\\\\\\\
\\\\\" must be one of \\\\\\\\\\\\\\\"Forever\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\
\"UntilCallEnd\\\\\\\\\\\\\\\" or \\\\\\\\\\\\\\\"Never\\\\\\\\\\\\\\\". See \
?ApplyPauliTransferMap.\\\\\\\"\\\"}]\\)\"", 2, 141, 23, 32463720414734710359,
    "Local", "QuEST`ApplyPauliTransferMap"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{{3.917458751257202*^9, 3.917458758224103*^9}, 
   3.9174608690750732`*^9, 3.917461181608604*^9, 3.9175071102211723`*^9, 
   3.917515344659976*^9, 3.917515810993991*^9, 3.917516728154141*^9, 
   3.917516876659955*^9, {3.917516913515593*^9, 3.917516942751635*^9}, 
   3.917517897170616*^9, 3.917518517252955*^9, 3.918112328879951*^9, 
   3.920956159040224*^9, 3.921408318201921*^9, 3.921421747957321*^9, 
   3.9214821262923203`*^9, 3.921482162589463*^9},
 CellLabel->
  "During evaluation of \
In[137]:=",ExpressionUUID->"d0e36655-0950-4a57-965f-2410a6b7a9e0"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{{3.917458751269355*^9, 3.917458758234292*^9}, 
   3.9174608690881968`*^9, 3.917461181635681*^9, 3.917507110236259*^9, 
   3.917515344669443*^9, 3.917515811003214*^9, 3.91751672816315*^9, 
   3.917516876670767*^9, {3.917516913526849*^9, 3.917516942764234*^9}, 
   3.9175178971820087`*^9, 3.9175185172615213`*^9, 3.9181123289280767`*^9, 
   3.920956159048543*^9, 3.921408318210622*^9, 3.92142174796489*^9, 
   3.921482126303337*^9, 3.921482162597857*^9},
 CellLabel->
  "Out[141]=",ExpressionUUID->"49390e10-eeec-4c9b-b53f-0c487edeede7"],

Cell[BoxData[
 TemplateBox[{
  "ApplyPauliTransferMap", "error", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"Option \\\\\\\\\\\\\\\"CacheMaps\\\\\\\\\\\
\\\\\" must be one of \\\\\\\\\\\\\\\"Forever\\\\\\\\\\\\\\\", \\\\\\\\\\\\\\\
\"UntilCallEnd\\\\\\\\\\\\\\\" or \\\\\\\\\\\\\\\"Never\\\\\\\\\\\\\\\". See \
?ApplyPauliTransferMap.\\\\\\\"\\\"}]\\)\"", 2, 142, 24, 32463720414734710359,
    "Local", "QuEST`ApplyPauliTransferMap"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{{3.917458751257202*^9, 3.917458758224103*^9}, 
   3.9174608690750732`*^9, 3.917461181608604*^9, 3.9175071102211723`*^9, 
   3.917515344659976*^9, 3.917515810993991*^9, 3.917516728154141*^9, 
   3.917516876659955*^9, {3.917516913515593*^9, 3.917516942751635*^9}, 
   3.917517897170616*^9, 3.917518517252955*^9, 3.918112328879951*^9, 
   3.920956159040224*^9, 3.921408318201921*^9, 3.921421747957321*^9, 
   3.9214821262923203`*^9, 3.9214821625994453`*^9},
 CellLabel->
  "During evaluation of \
In[137]:=",ExpressionUUID->"d39a7be8-8bb4-43a0-9cdc-a8a7e262cf3e"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{{3.917458751269355*^9, 3.917458758234292*^9}, 
   3.9174608690881968`*^9, 3.917461181635681*^9, 3.917507110236259*^9, 
   3.917515344669443*^9, 3.917515811003214*^9, 3.91751672816315*^9, 
   3.917516876670767*^9, {3.917516913526849*^9, 3.917516942764234*^9}, 
   3.9175178971820087`*^9, 3.9175185172615213`*^9, 3.9181123289280767`*^9, 
   3.920956159048543*^9, 3.921408318210622*^9, 3.92142174796489*^9, 
   3.921482126303337*^9, 3.9214821626072617`*^9},
 CellLabel->
  "Out[142]=",ExpressionUUID->"a84ed789-33bf-4068-bc45-7641d59d1fff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   SubscriptBox["X", "0"], ",", " ", 
   RowBox[{"{", 
    SubscriptBox["X", "0"], "}"}], ",", " ", 
   RowBox[{"\"\<BadOption\>\"", "->", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9174587276636*^9, 3.9174587442874928`*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"98351ce0-c14b-47d6-bcd0-e5f17d70449a"],

Cell[BoxData[
 TemplateBox[{
  "OptionValue", "nodef", 
   "\"Unknown option \\!\\(\\*RowBox[{\\\"\\\\\\\"BadOption\\\\\\\"\\\"}]\\) \
for \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"ApplyPauliTransferMap\\\", \
\\\",\\\", \\\"CalcPauliTransferMap\\\"}], \\\"}\\\"}]\\).\"", 2, 143, 25, 
   32463720414734710359, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.917458744573969*^9, 3.917460871183836*^9, 3.917507112551908*^9, 
   3.917515346366869*^9, 3.917516729742825*^9, 3.917516876679636*^9, {
   3.917517897326586*^9, 3.91751789967703*^9}, 3.917518520113069*^9, 
   3.9181123344352303`*^9, 3.92095615915033*^9, 3.921408318293804*^9, 
   3.921421748046912*^9, 3.9214821264071617`*^9, 3.921482162648313*^9},
 CellLabel->
  "During evaluation of \
In[143]:=",ExpressionUUID->"31b3a262-3814-4e78-9e39-d5d22abd256d"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{
  3.917458744613175*^9, 3.9174608711931543`*^9, 3.917507112562175*^9, 
   3.917515346375291*^9, 3.917516729750976*^9, 3.9175168766889353`*^9, {
   3.917517897334971*^9, 3.917517899688282*^9}, 3.9175185201216173`*^9, 
   3.918112334465147*^9, 3.920956159159773*^9, 3.921408318301449*^9, 
   3.9214217480538597`*^9, 3.921482126416576*^9, 3.921482162656886*^9},
 CellLabel->
  "Out[143]=",ExpressionUUID->"93e46303-5028-4262-bd91-4cc52509277f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   SubscriptBox["X", "0"], ",", " ", 
   RowBox[{"{", 
    SubscriptBox["X", "0"], "}"}], ",", " ", 
   RowBox[{
   "\"\<CombineStates\>\"", "->", 
    "\"\<Only valid for CalcPauliTransferEval\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9175203372984467`*^9, 3.9175203599730663`*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"9e783753-2034-4818-b52f-4a9c51940ab6"],

Cell[BoxData[
 TemplateBox[{
  "OptionValue", "nodef", 
   "\"Unknown option \\!\\(\\*RowBox[{\\\"\\\\\\\"CombineStates\\\\\\\"\\\"}]\
\\) for \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"ApplyPauliTransferMap\\\", \\\
\",\\\", \\\"CalcPauliTransferMap\\\"}], \\\"}\\\"}]\\).\"", 2, 144, 26, 
   32463720414734710359, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.9175203404723053`*^9, 3.917520360238091*^9}, 
   3.918112345298471*^9, 3.92095615916726*^9, 3.9214083183088017`*^9, 
   3.921421748060486*^9, 3.9214821264247103`*^9, 3.921482162665936*^9},
 CellLabel->
  "During evaluation of \
In[144]:=",ExpressionUUID->"04252d7f-f2b2-4877-97b6-a034df3fb734"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{{3.917520340494502*^9, 3.917520360247919*^9}, 
   3.9181123453117113`*^9, 3.9209561591748867`*^9, 3.9214083183157883`*^9, 
   3.9214217480676813`*^9, 3.921482126433776*^9, 3.921482162674864*^9},
 CellLabel->
  "Out[144]=",ExpressionUUID->"da1e861d-a71f-4701-8d66-18c01fccdea4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{"a", ",", " ", 
   RowBox[{"{", 
    SubscriptBox["H", "0"], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   SubscriptBox["X", 
    RowBox[{"-", "1"}]], ",", " ", 
   RowBox[{"{", 
    SubscriptBox["H", "0"], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox["X", "0"], 
    SubscriptBox["X", "0"]}], ",", " ", 
   RowBox[{"{", 
    SubscriptBox["H", "0"], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ApplyPauliTransferMap", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox["X", "0"], 
    SubscriptBox["Y", "0"]}], ",", " ", 
   RowBox[{"{", 
    SubscriptBox["H", "0"], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.917461300142507*^9, 3.917461328364315*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"b5411d17-cd2d-4905-a25a-34172b1fa82f"],

Cell[BoxData[
 TemplateBox[{
  "ApplyPauliTransferMap", "error", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"Invalid arguments. See \
?ApplyPauliTransferMap\\\\\\\"\\\"}]\\)\"", 2, 145, 27, 32463720414734710359, 
   "Local", "QuEST`ApplyPauliTransferMap"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.921482162712544*^9},
 CellLabel->
  "During evaluation of \
In[145]:=",ExpressionUUID->"c37c89ce-7415-41f7-9d9b-a443c5a92abf"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{{3.917461302740288*^9, 3.91746132873555*^9}, 
   3.91750711362396*^9, 3.917515349025381*^9, 3.917516876733272*^9, 
   3.9175179011363373`*^9, 3.9175185187982883`*^9, 3.918112347306365*^9, 
   3.9209561592125*^9, 3.9214083183570023`*^9, 3.921421748100211*^9, 
   3.921482126467783*^9, 3.921482162721838*^9},
 CellLabel->
  "Out[145]=",ExpressionUUID->"70c60ae4-2a33-40f6-b2bd-791927d4ade9"],

Cell[BoxData[
 TemplateBox[{
  "ApplyPauliTransferMap", "error", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"Invalid arguments. See \
?ApplyPauliTransferMap\\\\\\\"\\\"}]\\)\"", 2, 146, 28, 32463720414734710359, 
   "Local", "QuEST`ApplyPauliTransferMap"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.921482162723278*^9},
 CellLabel->
  "During evaluation of \
In[145]:=",ExpressionUUID->"1db3879b-6eb0-47cf-b454-a0d220a3b9a0"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{{3.917461302740288*^9, 3.91746132873555*^9}, 
   3.91750711362396*^9, 3.917515349025381*^9, 3.917516876733272*^9, 
   3.9175179011363373`*^9, 3.9175185187982883`*^9, 3.918112347306365*^9, 
   3.9209561592125*^9, 3.9214083183570023`*^9, 3.921421748100211*^9, 
   3.921482126467783*^9, 3.921482162731618*^9},
 CellLabel->
  "Out[146]=",ExpressionUUID->"e2013e3b-5a6f-4939-ab9a-fc89b2d6d42d"],

Cell[BoxData[
 TemplateBox[{
  "ApplyPauliTransferMap", "error", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"Invalid arguments. See \
?ApplyPauliTransferMap\\\\\\\"\\\"}]\\)\"", 2, 147, 29, 32463720414734710359, 
   "Local", "QuEST`ApplyPauliTransferMap"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.921482162732996*^9},
 CellLabel->
  "During evaluation of \
In[145]:=",ExpressionUUID->"04416b1e-af0b-4849-8301-680733f0a143"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{{3.917461302740288*^9, 3.91746132873555*^9}, 
   3.91750711362396*^9, 3.917515349025381*^9, 3.917516876733272*^9, 
   3.9175179011363373`*^9, 3.9175185187982883`*^9, 3.918112347306365*^9, 
   3.9209561592125*^9, 3.9214083183570023`*^9, 3.921421748100211*^9, 
   3.921482126467783*^9, 3.921482162740324*^9},
 CellLabel->
  "Out[147]=",ExpressionUUID->"b53a2a8c-4aeb-4cc0-8d4c-72d60f5df503"],

Cell[BoxData[
 TemplateBox[{
  "ApplyPauliTransferMap", "error", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"Invalid arguments. See \
?ApplyPauliTransferMap\\\\\\\"\\\"}]\\)\"", 2, 148, 30, 32463720414734710359, 
   "Local", "QuEST`ApplyPauliTransferMap"},
  "MessageTemplate2"]], "Message", "MSG",
 CellChangeTimes->{3.921482162741845*^9},
 CellLabel->
  "During evaluation of \
In[145]:=",ExpressionUUID->"57b196d2-035f-4e0a-9454-ff7cc2f4f770"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{{3.917461302740288*^9, 3.91746132873555*^9}, 
   3.91750711362396*^9, 3.917515349025381*^9, 3.917516876733272*^9, 
   3.9175179011363373`*^9, 3.9175185187982883`*^9, 3.918112347306365*^9, 
   3.9209561592125*^9, 3.9214083183570023`*^9, 3.921421748100211*^9, 
   3.921482126467783*^9, 3.921482162750197*^9},
 CellLabel->
  "Out[148]=",ExpressionUUID->"9b01bcd6-ffad-4983-aa9f-ebca77b14a57"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{720, 806},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"efaffe79-647a-4f23-a4d0-ca12a3fc3daf"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 586, 9, 98, "Title",ExpressionUUID->"77f009f4-2175-44a8-80e3-db58a43dd7eb"],
Cell[1169, 33, 384, 8, 52, "Input",ExpressionUUID->"96dc3e19-ba26-4783-b8c5-af8507883921"],
Cell[CellGroupData[{
Cell[1578, 45, 296, 5, 69, "Chapter",ExpressionUUID->"2a8ec798-ae11-4a87-9bc0-81ab84d2fff7"],
Cell[CellGroupData[{
Cell[1899, 54, 211, 3, 30, "Input",ExpressionUUID->"fba5918a-c879-4e52-a985-86426b9044bd"],
Cell[2113, 59, 29028, 627, 525, "Output",ExpressionUUID->"96f4d8c9-34d2-4ee1-b962-700a047227ac"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31190, 692, 452, 7, 69, "Chapter",ExpressionUUID->"02bdf378-83ae-4892-994c-456dd1665801"],
Cell[CellGroupData[{
Cell[31667, 703, 147, 3, 67, "Section",ExpressionUUID->"3046ef3e-0cb3-4f31-95ea-17cc025e6c77"],
Cell[CellGroupData[{
Cell[31839, 710, 766, 18, 52, "Input",ExpressionUUID->"45ff0713-8931-405a-ae53-38ff226ea5a8"],
Cell[32608, 730, 21549, 413, 325, "Output",ExpressionUUID->"45d7f665-ec40-4a3c-8f2b-c6fdcdbda4b3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54194, 1148, 290, 7, 30, "Input",ExpressionUUID->"b0f0c915-3d90-428b-9c6e-5d706e32165a"],
Cell[54487, 1157, 868, 13, 34, "Output",ExpressionUUID->"2a2c0aec-2216-4084-8e08-b77690256392"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55392, 1175, 447, 12, 30, "Input",ExpressionUUID->"f9352ffb-345e-452e-921e-fcc508f30748"],
Cell[55842, 1189, 1211, 25, 34, "Output",ExpressionUUID->"a3b61aee-083f-46b9-8d16-da8f0906e2cc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57090, 1219, 746, 19, 52, "Input",ExpressionUUID->"b9b6b16b-a31e-4949-bc33-edc7a5f79b1f"],
Cell[57839, 1240, 4432, 127, 271, "Output",ExpressionUUID->"e77f81df-a5d8-4e63-a725-ddf566d76fff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62308, 1372, 907, 20, 115, "Input",ExpressionUUID->"cc66c4e6-f6e0-43ac-949d-f5632a4f07ab"],
Cell[63218, 1394, 705, 10, 34, "Output",ExpressionUUID->"ea5e0831-a3b9-4106-a4ba-60dffcb5fb34"],
Cell[63926, 1406, 842, 14, 34, "Output",ExpressionUUID->"140fe869-1700-4799-8378-9afa59bf2e4a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[64817, 1426, 152, 3, 67, "Section",ExpressionUUID->"be433be5-a593-4f0e-94b5-06232378443c"],
Cell[CellGroupData[{
Cell[64994, 1433, 156, 3, 54, "Subsection",ExpressionUUID->"a52df5a1-befc-45d2-889b-4e9464b770af"],
Cell[CellGroupData[{
Cell[65175, 1440, 2129, 56, 262, "Input",ExpressionUUID->"9b5a2ad9-abfb-455a-8b91-beb517e651e9"],
Cell[67307, 1498, 626, 8, 34, "Output",ExpressionUUID->"d048aa56-3739-497f-95d8-a6e5308fe939"],
Cell[67936, 1508, 607, 8, 34, "Output",ExpressionUUID->"7fda764b-941d-41d2-b113-ceed1d94fd83"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[68592, 1522, 156, 3, 54, "Subsection",ExpressionUUID->"b9caf1a0-e756-4922-8998-5ad1b1a00964"],
Cell[CellGroupData[{
Cell[68773, 1529, 2603, 77, 142, "Input",ExpressionUUID->"c66ea149-29c9-4f27-b0f8-8251de6bd847"],
Cell[71379, 1608, 4308, 77, 76, "Output",ExpressionUUID->"08de363a-2d11-4ad4-8971-a9215ca12d9e"]
}, Open  ]],
Cell[75702, 1688, 366, 11, 30, "Input",ExpressionUUID->"a8089472-2d7d-4be5-a4b1-eb23f61936a5"],
Cell[CellGroupData[{
Cell[76093, 1703, 161, 3, 45, "Subsubsection",ExpressionUUID->"704fc063-e71a-483d-938a-1edfcc421ec2"],
Cell[CellGroupData[{
Cell[76279, 1710, 2870, 79, 283, "Input",ExpressionUUID->"dcdfaba5-8ae8-4e22-832b-545c40681ef1"],
Cell[79152, 1791, 272, 5, 34, "Output",ExpressionUUID->"51ff0ef6-122d-4a81-b1d7-2552ac3678bd"],
Cell[79427, 1798, 253, 5, 34, "Output",ExpressionUUID->"bd837c36-67e0-438e-8f1e-7c02bc5e776e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[79729, 1809, 217, 4, 45, "Subsubsection",ExpressionUUID->"9e543dc8-93f2-4e1e-aeea-783b5bf33f1a"],
Cell[CellGroupData[{
Cell[79971, 1817, 2790, 75, 283, "Input",ExpressionUUID->"d3686214-0ec0-4f5e-b035-af9767c44778"],
Cell[82764, 1894, 271, 4, 34, "Output",ExpressionUUID->"753f1a92-966a-414d-bbf1-d2b9690c14b9"],
Cell[83038, 1900, 250, 4, 34, "Output",ExpressionUUID->"99224325-7db7-4c26-9bb4-d0c059a33db5"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[83361, 1912, 214, 4, 67, "Section",ExpressionUUID->"d511aed7-3357-4797-88d1-43dc0a7bfc96"],
Cell[CellGroupData[{
Cell[83600, 1920, 820, 22, 74, "Input",ExpressionUUID->"58b93675-da58-4ede-9231-b57778f18b10"],
Cell[84423, 1944, 467, 10, 34, "Output",ExpressionUUID->"881f4d07-1dfe-4b39-9fc8-03b1da4e73e5"],
Cell[84893, 1956, 298, 5, 34, "Output",ExpressionUUID->"2d66e525-f5a5-4a2b-b85d-f4cc605febb0"],
Cell[85194, 1963, 467, 11, 34, "Output",ExpressionUUID->"4ffc5016-a465-41b2-b64f-28302d4c58f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85698, 1979, 827, 23, 80, "Input",ExpressionUUID->"de6ce778-79ab-452a-8010-385ff3b5677d"],
Cell[86528, 2004, 279, 5, 34, "Output",ExpressionUUID->"3cbe2051-bb66-4f67-92d0-ba601f6610e8"],
Cell[86810, 2011, 277, 5, 34, "Output",ExpressionUUID->"6ed71808-bebb-4e15-8067-f314331bf3b2"],
Cell[87090, 2018, 277, 5, 34, "Output",ExpressionUUID->"683720db-fd0d-43cb-b9e4-aff0531240e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87404, 2028, 330, 8, 32, "Input",ExpressionUUID->"5484a5d2-d63d-41c4-bcae-aaf4671c0cbd"],
Cell[87737, 2038, 274, 5, 34, "Output",ExpressionUUID->"13c07b12-ccfa-45fa-9014-67f44778be9f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[88060, 2049, 204, 4, 67, "Section",ExpressionUUID->"97df6472-d787-4f5a-8287-e61d2d52d187"],
Cell[CellGroupData[{
Cell[88289, 2057, 157, 3, 54, "Subsection",ExpressionUUID->"4cf09147-19b7-4bc9-98fb-a74a6426f3a2"],
Cell[CellGroupData[{
Cell[88471, 2064, 1531, 43, 115, "Input",ExpressionUUID->"65f79189-1c3f-4635-80d7-8bc7ade43f68"],
Cell[90005, 2109, 831, 20, 34, "Output",ExpressionUUID->"19c39d34-df40-44b1-b551-3e30c5eb2577"],
Cell[90839, 2131, 828, 20, 34, "Output",ExpressionUUID->"eeae6282-cc43-49f3-aabe-368283664c52"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91704, 2156, 2185, 59, 241, "Input",ExpressionUUID->"bb5acbce-ae6f-4fda-9515-d95f2367d25e"],
Cell[93892, 2217, 2874, 87, 143, "Output",ExpressionUUID->"c5f5a0b1-e3b3-4738-9dbd-094baf3e7bdd"],
Cell[96769, 2306, 1136, 25, 140, "Output",ExpressionUUID->"fe7eda8e-fae9-4a0f-a8fe-5b1fbea5fc70"],
Cell[97908, 2333, 1136, 25, 140, "Output",ExpressionUUID->"1ed897d5-1daf-4095-9491-be5e025da615"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[99093, 2364, 218, 4, 54, "Subsection",ExpressionUUID->"4bbd4d88-d588-49ff-9cc7-972de201b1c6"],
Cell[CellGroupData[{
Cell[99336, 2372, 721, 21, 58, "Input",ExpressionUUID->"a2fb38da-aa8a-47b2-bbe4-58e580d9a788"],
Cell[100060, 2395, 528, 13, 50, "Output",ExpressionUUID->"2fa03b98-c74d-45ac-a155-88ac38115342"],
Cell[100591, 2410, 759, 22, 50, "Output",ExpressionUUID->"219d6378-40ed-4f34-8655-fa461f4db53e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[101423, 2440, 398, 6, 69, "Chapter",ExpressionUUID->"5524d7f6-8b97-42e4-861f-3caad3568fb8"],
Cell[CellGroupData[{
Cell[101846, 2450, 331, 8, 32, "Input",ExpressionUUID->"189cd6f5-3fa7-454e-9d2f-9740c605f59a"],
Cell[102180, 2460, 559, 11, 28, "Message",ExpressionUUID->"dcfed6fb-88d6-461e-b74c-0db5bce69f50"],
Cell[102742, 2473, 679, 13, 63, "Message",ExpressionUUID->"2fe503b3-bea2-4417-b83b-eb72455bdb79"],
Cell[103424, 2488, 281, 5, 34, "Output",ExpressionUUID->"41c1462a-3557-4e65-9817-28cda586d505"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103742, 2498, 469, 10, 30, "Input",ExpressionUUID->"ad62fa39-7002-46c3-8a53-8db709830815"],
Cell[104214, 2510, 868, 16, 28, "Message",ExpressionUUID->"b58318d4-80b5-49b1-add5-e0c12a0fccb2"],
Cell[105085, 2528, 992, 18, 28, "Message",ExpressionUUID->"fab2bcd6-2b33-4c17-873d-92482710c1b3"],
Cell[106080, 2548, 663, 10, 34, "Output",ExpressionUUID->"45da8d55-3260-4ea4-bdcd-8788edfb6043"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106780, 2563, 1754, 47, 137, "Input",ExpressionUUID->"830f3f61-dea7-4f53-9f6b-d7ac57b1de9f"],
Cell[108537, 2612, 1048, 18, 46, "Message",ExpressionUUID->"cc63ac0e-18b2-4a6d-84ea-443e786fc015"],
Cell[109588, 2632, 589, 9, 34, "Output",ExpressionUUID->"5a351e56-ca04-475b-a9ea-47169c8e67ad"],
Cell[110180, 2643, 1046, 18, 46, "Message",ExpressionUUID->"367a16fd-40dc-4707-950d-d63bbb10609d"],
Cell[111229, 2663, 589, 9, 34, "Output",ExpressionUUID->"5f0c5ee0-db8f-450e-b938-ae6efad06a21"],
Cell[111821, 2674, 1046, 18, 46, "Message",ExpressionUUID->"02bec6ff-0db5-4942-8dc6-2475b729811d"],
Cell[112870, 2694, 591, 9, 34, "Output",ExpressionUUID->"07b1325c-d101-4e3a-b8bf-352578e84b10"],
Cell[113464, 2705, 1046, 18, 46, "Message",ExpressionUUID->"3905d76c-2cda-42bf-ac95-541666ad8fb5"],
Cell[114513, 2725, 589, 9, 34, "Output",ExpressionUUID->"ce94b8c7-da53-4394-991e-4d0e6ea15b8a"],
Cell[115105, 2736, 1046, 18, 46, "Message",ExpressionUUID->"d0e36655-0950-4a57-965f-2410a6b7a9e0"],
Cell[116154, 2756, 589, 9, 34, "Output",ExpressionUUID->"49390e10-eeec-4c9b-b53f-0c487edeede7"],
Cell[116746, 2767, 1048, 18, 46, "Message",ExpressionUUID->"d39a7be8-8bb4-43a0-9cdc-a8a7e262cf3e"],
Cell[117797, 2787, 591, 9, 34, "Output",ExpressionUUID->"a84ed789-33bf-4068-bc45-7641d59d1fff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118425, 2801, 381, 9, 30, "Input",ExpressionUUID->"98351ce0-c14b-47d6-bcd0-e5f17d70449a"],
Cell[118809, 2812, 838, 16, 28, "Message",ExpressionUUID->"31b3a262-3814-4e78-9e39-d5d22abd256d"],
Cell[119650, 2830, 496, 8, 34, "Output",ExpressionUUID->"93e46303-5028-4262-bd91-4cc52509277f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120183, 2843, 438, 11, 52, "Input",ExpressionUUID->"9e783753-2034-4818-b52f-4a9c51940ab6"],
Cell[120624, 2856, 680, 13, 28, "Message",ExpressionUUID->"04252d7f-f2b2-4877-97b6-a034df3fb734"],
Cell[121307, 2871, 331, 5, 34, "Output",ExpressionUUID->"da1e861d-a71f-4701-8d66-18c01fccdea4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121675, 2881, 931, 27, 94, "Input",ExpressionUUID->"b5411d17-cd2d-4905-a25a-34172b1fa82f"],
Cell[122609, 2910, 438, 10, 28, "Message",ExpressionUUID->"c37c89ce-7415-41f7-9d9b-a443c5a92abf"],
Cell[123050, 2922, 443, 7, 34, "Output",ExpressionUUID->"70c60ae4-2a33-40f6-b2bd-791927d4ade9"],
Cell[123496, 2931, 438, 10, 28, "Message",ExpressionUUID->"1db3879b-6eb0-47cf-b454-a0d220a3b9a0"],
Cell[123937, 2943, 443, 7, 34, "Output",ExpressionUUID->"e2013e3b-5a6f-4939-ab9a-fc89b2d6d42d"],
Cell[124383, 2952, 438, 10, 28, "Message",ExpressionUUID->"04416b1e-af0b-4849-8301-680733f0a143"],
Cell[124824, 2964, 443, 7, 34, "Output",ExpressionUUID->"b53a2a8c-4aeb-4cc0-8d4c-72d60f5df503"],
Cell[125270, 2973, 438, 10, 28, "Message",ExpressionUUID->"57b196d2-035f-4e0a-9454-ff7cc2f4f770"],
Cell[125711, 2985, 443, 7, 34, "Output",ExpressionUUID->"9b01bcd6-ffad-4983-aa9f-ebca77b14a57"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

